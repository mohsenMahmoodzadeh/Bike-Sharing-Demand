<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>5be895b3465240b2b8318fb78cf922ee</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<section id="predict-bike-sharing-demand-with-autogluon"
class="cell markdown" id="IFlm5Fak2ZP_">
<h1>Predict Bike Sharing Demand with AutoGluon</h1>
</section>
<div class="cell markdown" id="Ol2Mvcsf2gpQ">
<p>In this project, you'll use the AutoGluon library to train several
models for the Bike Sharing Demand competition in Kaggle. You will be
using Tabular Prediction to fit data from CSV files provided by the
competition.</p>
</div>
<section
id="step-1-download-the-kaggle-dataset-using-the-kaggle-python-library"
class="cell markdown" id="fZRA0Zbe2kr9">
<h2>Step 1: Download the Kaggle dataset using the kaggle python
library</h2>
</section>
<section id="install-packages" class="cell markdown" id="UxcKgrN02pO3">
<h3>Install packages</h3>
</section>
<div class="cell code" data-execution_count="2"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="umYjXGdx2le-" data-outputId="78e9b7ab-330d-4191-a183-f25bb9923a49">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install <span class="op">-</span>U pip</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install <span class="op">-</span>U setuptools wheel</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install <span class="op">-</span>U <span class="st">&quot;mxnet&lt;2.0.0&quot;</span> </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install bokeh<span class="op">==</span><span class="fl">2.0.1</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install autogluon <span class="op">--</span>no<span class="op">-</span>cache<span class="op">-</span><span class="bu">dir</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Without --no-cache-dir, smaller aws instances may have trouble installing</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Requirement already satisfied: pip in /usr/local/lib/python3.8/dist-packages (21.1.3)
Collecting pip
  Downloading pip-22.3.1-py3-none-any.whl (2.1 MB)
pting uninstall: pip
    Found existing installation: pip 21.1.3
    Uninstalling pip-21.1.3:
      Successfully uninstalled pip-21.1.3
Successfully installed pip-22.3.1
Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Requirement already satisfied: setuptools in /usr/local/lib/python3.8/dist-packages (57.4.0)
Collecting setuptools
  Downloading setuptools-65.6.3-py3-none-any.whl (1.2 MB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.2/1.2 MB 34.7 MB/s eta 0:00:00
ent already satisfied: wheel in /usr/local/lib/python3.8/dist-packages (0.38.4)
Installing collected packages: setuptools
  Attempting uninstall: setuptools
    Found existing installation: setuptools 57.4.0
    Uninstalling setuptools-57.4.0:
      Successfully uninstalled setuptools-57.4.0
ERROR: pip&#39;s dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
ipython 7.9.0 requires jedi&gt;=0.10, which is not installed.
Successfully installed setuptools-65.6.3
WARNING: Running pip as the &#39;root&#39; user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv
Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Collecting mxnet&lt;2.0.0
  Downloading mxnet-1.9.1-py3-none-manylinux2014_x86_64.whl (49.1 MB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 49.1/49.1 MB 13.9 MB/s eta 0:00:00
ent already satisfied: requests&lt;3,&gt;=2.20.0 in /usr/local/lib/python3.8/dist-packages (from mxnet&lt;2.0.0) (2.23.0)
Requirement already satisfied: numpy&lt;2.0.0,&gt;1.16.0 in /usr/local/lib/python3.8/dist-packages (from mxnet&lt;2.0.0) (1.21.6)
Collecting graphviz&lt;0.9.0,&gt;=0.8.1
  Downloading graphviz-0.8.4-py2.py3-none-any.whl (16 kB)
Requirement already satisfied: chardet&lt;4,&gt;=3.0.2 in /usr/local/lib/python3.8/dist-packages (from requests&lt;3,&gt;=2.20.0-&gt;mxnet&lt;2.0.0) (3.0.4)
Requirement already satisfied: idna&lt;3,&gt;=2.5 in /usr/local/lib/python3.8/dist-packages (from requests&lt;3,&gt;=2.20.0-&gt;mxnet&lt;2.0.0) (2.10)
Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,&lt;1.26,&gt;=1.21.1 in /usr/local/lib/python3.8/dist-packages (from requests&lt;3,&gt;=2.20.0-&gt;mxnet&lt;2.0.0) (1.24.3)
Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.8/dist-packages (from requests&lt;3,&gt;=2.20.0-&gt;mxnet&lt;2.0.0) (2022.12.7)
Installing collected packages: graphviz, mxnet
  Attempting uninstall: graphviz
    Found existing installation: graphviz 0.10.1
    Uninstalling graphviz-0.10.1:
      Successfully uninstalled graphviz-0.10.1
Successfully installed graphviz-0.8.4 mxnet-1.9.1
WARNING: Running pip as the &#39;root&#39; user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv
Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Collecting bokeh==2.0.1
  Downloading bokeh-2.0.1.tar.gz (8.6 MB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 8.6/8.6 MB 15.1 MB/s eta 0:00:00
etadata (setup.py) ... ent already satisfied: PyYAML&gt;=3.10 in /usr/local/lib/python3.8/dist-packages (from bokeh==2.0.1) (6.0)
Requirement already satisfied: python-dateutil&gt;=2.1 in /usr/local/lib/python3.8/dist-packages (from bokeh==2.0.1) (2.8.2)
Requirement already satisfied: Jinja2&gt;=2.7 in /usr/local/lib/python3.8/dist-packages (from bokeh==2.0.1) (2.11.3)
Requirement already satisfied: numpy&gt;=1.11.3 in /usr/local/lib/python3.8/dist-packages (from bokeh==2.0.1) (1.21.6)
Requirement already satisfied: pillow&gt;=4.0 in /usr/local/lib/python3.8/dist-packages (from bokeh==2.0.1) (7.1.2)
Requirement already satisfied: packaging&gt;=16.8 in /usr/local/lib/python3.8/dist-packages (from bokeh==2.0.1) (21.3)
Requirement already satisfied: tornado&gt;=5 in /usr/local/lib/python3.8/dist-packages (from bokeh==2.0.1) (6.0.4)
Requirement already satisfied: typing_extensions&gt;=3.7.4 in /usr/local/lib/python3.8/dist-packages (from bokeh==2.0.1) (4.4.0)
Requirement already satisfied: MarkupSafe&gt;=0.23 in /usr/local/lib/python3.8/dist-packages (from Jinja2&gt;=2.7-&gt;bokeh==2.0.1) (2.0.1)
Requirement already satisfied: pyparsing!=3.0.5,&gt;=2.0.2 in /usr/local/lib/python3.8/dist-packages (from packaging&gt;=16.8-&gt;bokeh==2.0.1) (3.0.9)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.8/dist-packages (from python-dateutil&gt;=2.1-&gt;bokeh==2.0.1) (1.15.0)
Building wheels for collected packages: bokeh
  Building wheel for bokeh (setup.py) ... e=bokeh-2.0.1-py3-none-any.whl size=9080017 sha256=2b4c81b605988a82f1211acc0af69e54b841a3aa277647c774451c54ed4906b6
  Stored in directory: /root/.cache/pip/wheels/df/5e/9c/8bd156f0e272ecafaf8084bf6bd69ccb317e6fe6105edba7b2
Successfully built bokeh
Installing collected packages: bokeh
  Attempting uninstall: bokeh
    Found existing installation: bokeh 2.3.3
    Uninstalling bokeh-2.3.3:
      Successfully uninstalled bokeh-2.3.3
ERROR: pip&#39;s dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
panel 0.12.1 requires bokeh&lt;2.4.0,&gt;=2.3.0, but you have bokeh 2.0.1 which is incompatible.
Successfully installed bokeh-2.0.1
WARNING: Running pip as the &#39;root&#39; user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv
Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Collecting autogluon
  Downloading autogluon-0.6.1-py3-none-any.whl (9.8 kB)
Collecting autogluon.core[all]==0.6.1
  Downloading autogluon.core-0.6.1-py3-none-any.whl (226 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 226.6/226.6 kB 26.0 MB/s eta 0:00:00
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 49.8/49.8 kB 176.7 MB/s eta 0:00:00
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 62.1/62.1 kB 196.7 MB/s eta 0:00:00
ultimodal==0.6.1
  Downloading autogluon.multimodal-0.6.1-py3-none-any.whl (289 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 289.7/289.7 kB 220.0 MB/s eta 0:00:00
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 60.0/60.0 kB 200.6 MB/s eta 0:00:00
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 286.0/286.0 kB 291.6 MB/s eta 0:00:00
eseries[all]==0.6.1
  Downloading autogluon.timeseries-0.6.1-py3-none-any.whl (103 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 103.0/103.0 kB 218.1 MB/s eta 0:00:00
ent already satisfied: matplotlib in /usr/local/lib/python3.8/dist-packages (from autogluon.core[all]==0.6.1-&gt;autogluon) (3.2.2)
Collecting autogluon.common==0.6.1
  Downloading autogluon.common-0.6.1-py3-none-any.whl (41 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 41.5/41.5 kB 151.3 MB/s eta 0:00:00
ent already satisfied: scikit-learn&lt;1.2,&gt;=1.0.0 in /usr/local/lib/python3.8/dist-packages (from autogluon.core[all]==0.6.1-&gt;autogluon) (1.0.2)
Collecting boto3
  Downloading boto3-1.26.41-py3-none-any.whl (132 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 132.7/132.7 kB 260.8 MB/s eta 0:00:00
ent already satisfied: scipy&lt;1.10.0,&gt;=1.5.4 in /usr/local/lib/python3.8/dist-packages (from autogluon.core[all]==0.6.1-&gt;autogluon) (1.7.3)
Requirement already satisfied: requests in /usr/local/lib/python3.8/dist-packages (from autogluon.core[all]==0.6.1-&gt;autogluon) (2.23.0)
Collecting dask&lt;=2021.11.2,&gt;=2021.09.1
  Downloading dask-2021.11.2-py3-none-any.whl (1.0 MB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.0/1.0 MB 274.9 MB/s eta 0:00:00
ent already satisfied: numpy&lt;1.24,&gt;=1.21 in /usr/local/lib/python3.8/dist-packages (from autogluon.core[all]==0.6.1-&gt;autogluon) (1.21.6)
Requirement already satisfied: tqdm&gt;=4.38.0 in /usr/local/lib/python3.8/dist-packages (from autogluon.core[all]==0.6.1-&gt;autogluon) (4.64.1)
Collecting distributed&lt;=2021.11.2,&gt;=2021.09.1
  Downloading distributed-2021.11.2-py3-none-any.whl (802 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 802.2/802.2 kB 303.4 MB/s eta 0:00:00
ent already satisfied: pandas!=1.4.0,&lt;1.6,&gt;=1.2.5 in /usr/local/lib/python3.8/dist-packages (from autogluon.core[all]==0.6.1-&gt;autogluon) (1.3.5)
Collecting ray&lt;2.1,&gt;=2.0
  Downloading ray-2.0.1-cp38-cp38-manylinux2014_x86_64.whl (60.2 MB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 60.2/60.2 MB 214.5 MB/s eta 0:00:00
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.6/1.6 MB 308.7 MB/s eta 0:00:00
anylinux_2_12_x86_64.manylinux2010_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (280 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 280.2/280.2 kB 310.4 MB/s eta 0:00:00
art-open&lt;5.3.0,&gt;=5.2.1
  Downloading smart_open-5.2.1-py3-none-any.whl (58 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 58.6/58.6 kB 216.3 MB/s eta 0:00:00
im&lt;=0.2.1,&gt;0.1.5
  Downloading openmim-0.2.1-py2.py3-none-any.whl (49 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 49.7/49.7 kB 231.5 MB/s eta 0:00:00
age&lt;0.20.0,&gt;=0.19.1
  Downloading scikit_image-0.19.3-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (14.0 MB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 14.0/14.0 MB 252.7 MB/s eta 0:00:00
anylinux1_x86_64.whl (19.1 MB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 19.1/19.1 MB 194.0 MB/s eta 0:00:00
anylinux1_x86_64.whl (1.9 MB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.9/1.9 MB 299.5 MB/s eta 0:00:00
ent already satisfied: text-unidecode&lt;=1.3 in /usr/local/lib/python3.8/dist-packages (from autogluon.multimodal==0.6.1-&gt;autogluon) (1.3)
Collecting seqeval&lt;=1.2.2
  Downloading seqeval-1.2.2.tar.gz (43 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 43.6/43.6 kB 197.4 MB/s eta 0:00:00
etadata (setup.py) ... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 708.1/708.1 kB 326.8 MB/s eta 0:00:00
etric-learning&lt;1.4.0,&gt;=1.3.0
  Downloading pytorch_metric_learning-1.3.2-py3-none-any.whl (109 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 109.4/109.4 kB 240.2 MB/s eta 0:00:00
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 72.9/72.9 kB 244.6 MB/s eta 0:00:00
m&lt;0.7.0
  Downloading timm-0.6.12-py3-none-any.whl (549 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 549.1/549.1 kB 285.3 MB/s eta 0:00:00
egaconf&lt;2.2.0,&gt;=2.1.1
  Downloading omegaconf-2.1.2-py3-none-any.whl (74 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 74.7/74.7 kB 266.6 MB/s eta 0:00:00
ent already satisfied: defusedxml&lt;=0.7.1,&gt;=0.7.1 in /usr/local/lib/python3.8/dist-packages (from autogluon.multimodal==0.6.1-&gt;autogluon) (0.7.1)
Collecting nlpaug&lt;=1.1.10,&gt;=1.1.10
  Downloading nlpaug-1.1.10-py3-none-any.whl (410 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 410.8/410.8 kB 292.3 MB/s eta 0:00:00
ent already satisfied: jsonschema&lt;=4.8.0 in /usr/local/lib/python3.8/dist-packages (from autogluon.multimodal==0.6.1-&gt;autogluon) (4.3.3)
Collecting torchmetrics&lt;0.9.0,&gt;=0.8.0
  Downloading torchmetrics-0.8.2-py3-none-any.whl (409 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 409.8/409.8 kB 265.5 MB/s eta 0:00:00
ers&lt;4.24.0,&gt;=4.23.0
  Downloading transformers-4.23.1-py3-none-any.whl (5.3 MB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5.3/5.3 MB 278.6 MB/s eta 0:00:00
anylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.2 MB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3.2/3.2 MB 330.6 MB/s eta 0:00:00
anylinux1_x86_64.whl (776.3 MB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 776.3/776.3 MB 201.6 MB/s eta 0:00:00
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 148.8/148.8 kB 283.3 MB/s eta 0:00:00
ent already satisfied: nltk&lt;4.0.0,&gt;=3.4.5 in /usr/local/lib/python3.8/dist-packages (from autogluon.multimodal==0.6.1-&gt;autogluon) (3.7)
Collecting nptyping&lt;1.5.0,&gt;=1.4.4
  Downloading nptyping-1.4.4-py3-none-any.whl (31 kB)
Collecting fairscale&lt;=0.4.6,&gt;=0.4.5
  Downloading fairscale-0.4.6.tar.gz (248 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 248.2/248.2 kB 281.2 MB/s eta 0:00:00
ents to build wheel ... etadata (pyproject.toml) ... entations&lt;=1.2.0,&gt;=1.1.0
  Downloading albumentations-1.2.0-py3-none-any.whl (113 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 113.5/113.5 kB 228.3 MB/s eta 0:00:00
anylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.3 MB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.3/1.3 MB 272.5 MB/s eta 0:00:00
ent already satisfied: networkx&lt;3.0,&gt;=2.3 in /usr/local/lib/python3.8/dist-packages (from autogluon.tabular[all]==0.6.1-&gt;autogluon) (2.8.8)
Collecting xgboost&lt;1.8,&gt;=1.6
  Downloading xgboost-1.7.2-py3-none-manylinux2014_x86_64.whl (193.6 MB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 193.6/193.6 MB 107.5 MB/s eta 0:00:00
ent already satisfied: fastai&lt;2.8,&gt;=2.3.1 in /usr/local/lib/python3.8/dist-packages (from autogluon.tabular[all]==0.6.1-&gt;autogluon) (2.7.10)
Collecting catboost&lt;1.2,&gt;=1.0
  Downloading catboost-1.1.1-cp38-none-manylinux1_x86_64.whl (76.6 MB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 76.6/76.6 MB 171.4 MB/s eta 0:00:00
&lt;3.4,&gt;=3.3
  Downloading lightgbm-3.3.3-py3-none-manylinux1_x86_64.whl (2.0 MB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.0/2.0 MB 211.8 MB/s eta 0:00:00
odels~=0.13.0
  Downloading statsmodels-0.13.5-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (9.9 MB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 9.9/9.9 MB 89.0 MB/s eta 0:00:00
ent already satisfied: joblib~=1.1 in /usr/local/lib/python3.8/dist-packages (from autogluon.timeseries[all]==0.6.1-&gt;autogluon) (1.2.0)
Collecting psutil&lt;6,&gt;=5.7.3
  Downloading psutil-5.8.0-cp38-cp38-manylinux2010_x86_64.whl (296 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 296.0/296.0 kB 129.5 MB/s eta 0:00:00
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.0/1.0 MB 213.5 MB/s eta 0:00:00
e&lt;0.14,&gt;=0.13.1
  Downloading sktime-0.13.4-py3-none-any.whl (7.0 MB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 7.0/7.0 MB 183.7 MB/s eta 0:00:00
darima~=1.8.2
  Downloading pmdarima-1.8.5-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.manylinux_2_24_x86_64.whl (1.5 MB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.5/1.5 MB 201.6 MB/s eta 0:00:00
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 43.8/43.8 kB 199.2 MB/s eta 0:00:00
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.3/1.3 MB 203.7 MB/s eta 0:00:00
ent already satisfied: setuptools in /usr/local/lib/python3.8/dist-packages (from autogluon.common==0.6.1-&gt;autogluon.core[all]==0.6.1-&gt;autogluon) (65.6.3)
Requirement already satisfied: packaging&gt;=20.0 in /usr/local/lib/python3.8/dist-packages (from accelerate&lt;0.14,&gt;=0.9-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (21.3)
Requirement already satisfied: pyyaml in /usr/local/lib/python3.8/dist-packages (from accelerate&lt;0.14,&gt;=0.9-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (6.0)
Requirement already satisfied: qudida&gt;=0.0.4 in /usr/local/lib/python3.8/dist-packages (from albumentations&lt;=1.2.0,&gt;=1.1.0-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (0.0.4)
Requirement already satisfied: opencv-python-headless&gt;=4.1.1 in /usr/local/lib/python3.8/dist-packages (from albumentations&lt;=1.2.0,&gt;=1.1.0-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (4.6.0.66)
Collecting albumentations&lt;=1.2.0,&gt;=1.1.0
  Downloading albumentations-1.1.0-py3-none-any.whl (102 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 102.4/102.4 kB 179.0 MB/s eta 0:00:00
ent already satisfied: six in /usr/local/lib/python3.8/dist-packages (from catboost&lt;1.2,&gt;=1.0-&gt;autogluon.tabular[all]==0.6.1-&gt;autogluon) (1.15.0)
Requirement already satisfied: graphviz in /usr/local/lib/python3.8/dist-packages (from catboost&lt;1.2,&gt;=1.0-&gt;autogluon.tabular[all]==0.6.1-&gt;autogluon) (0.8.4)
Requirement already satisfied: plotly in /usr/local/lib/python3.8/dist-packages (from catboost&lt;1.2,&gt;=1.0-&gt;autogluon.tabular[all]==0.6.1-&gt;autogluon) (5.5.0)
Requirement already satisfied: fsspec&gt;=0.6.0 in /usr/local/lib/python3.8/dist-packages (from dask&lt;=2021.11.2,&gt;=2021.09.1-&gt;autogluon.core[all]==0.6.1-&gt;autogluon) (2022.11.0)
Requirement already satisfied: cloudpickle&gt;=1.1.1 in /usr/local/lib/python3.8/dist-packages (from dask&lt;=2021.11.2,&gt;=2021.09.1-&gt;autogluon.core[all]==0.6.1-&gt;autogluon) (1.5.0)
Requirement already satisfied: partd&gt;=0.3.10 in /usr/local/lib/python3.8/dist-packages (from dask&lt;=2021.11.2,&gt;=2021.09.1-&gt;autogluon.core[all]==0.6.1-&gt;autogluon) (1.3.0)
Requirement already satisfied: toolz&gt;=0.8.2 in /usr/local/lib/python3.8/dist-packages (from dask&lt;=2021.11.2,&gt;=2021.09.1-&gt;autogluon.core[all]==0.6.1-&gt;autogluon) (0.12.0)
Requirement already satisfied: jinja2 in /usr/local/lib/python3.8/dist-packages (from distributed&lt;=2021.11.2,&gt;=2021.09.1-&gt;autogluon.core[all]==0.6.1-&gt;autogluon) (2.11.3)
Requirement already satisfied: tornado&gt;=6.0.3 in /usr/local/lib/python3.8/dist-packages (from distributed&lt;=2021.11.2,&gt;=2021.09.1-&gt;autogluon.core[all]==0.6.1-&gt;autogluon) (6.0.4)
Requirement already satisfied: msgpack&gt;=0.6.0 in /usr/local/lib/python3.8/dist-packages (from distributed&lt;=2021.11.2,&gt;=2021.09.1-&gt;autogluon.core[all]==0.6.1-&gt;autogluon) (1.0.4)
Requirement already satisfied: sortedcontainers!=2.0.0,!=2.0.1 in /usr/local/lib/python3.8/dist-packages (from distributed&lt;=2021.11.2,&gt;=2021.09.1-&gt;autogluon.core[all]==0.6.1-&gt;autogluon) (2.4.0)
Requirement already satisfied: click&gt;=6.6 in /usr/local/lib/python3.8/dist-packages (from distributed&lt;=2021.11.2,&gt;=2021.09.1-&gt;autogluon.core[all]==0.6.1-&gt;autogluon) (7.1.2)
Requirement already satisfied: tblib&gt;=1.6.0 in /usr/local/lib/python3.8/dist-packages (from distributed&lt;=2021.11.2,&gt;=2021.09.1-&gt;autogluon.core[all]==0.6.1-&gt;autogluon) (1.7.0)
Requirement already satisfied: zict&gt;=0.1.3 in /usr/local/lib/python3.8/dist-packages (from distributed&lt;=2021.11.2,&gt;=2021.09.1-&gt;autogluon.core[all]==0.6.1-&gt;autogluon) (2.2.0)
Collecting huggingface-hub&gt;=0.7.0
  Downloading huggingface_hub-0.11.1-py3-none-any.whl (182 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 182.4/182.4 kB 242.5 MB/s eta 0:00:00
ent already satisfied: dill in /usr/local/lib/python3.8/dist-packages (from evaluate&lt;=0.3.0-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (0.3.6)
Collecting responses&lt;0.19
  Downloading responses-0.18.0-py3-none-any.whl (38 kB)
Collecting xxhash
  Downloading xxhash-3.2.0-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (213 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 213.0/213.0 kB 183.2 MB/s eta 0:00:00
ultiprocess
  Downloading multiprocess-0.70.14-py38-none-any.whl (132 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 132.0/132.0 kB 259.8 MB/s eta 0:00:00
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 452.9/452.9 kB 146.4 MB/s eta 0:00:00
ent already satisfied: fastcore&lt;1.6,&gt;=1.4.5 in /usr/local/lib/python3.8/dist-packages (from fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.6.1-&gt;autogluon) (1.5.27)
Requirement already satisfied: fastdownload&lt;2,&gt;=0.0.5 in /usr/local/lib/python3.8/dist-packages (from fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.6.1-&gt;autogluon) (0.0.7)
Requirement already satisfied: fastprogress&gt;=0.2.4 in /usr/local/lib/python3.8/dist-packages (from fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.6.1-&gt;autogluon) (1.0.3)
Requirement already satisfied: spacy&lt;4 in /usr/local/lib/python3.8/dist-packages (from fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.6.1-&gt;autogluon) (3.4.4)
Requirement already satisfied: pip in /usr/local/lib/python3.8/dist-packages (from fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.6.1-&gt;autogluon) (22.3.1)
Collecting portalocker
  Downloading portalocker-2.6.0-py2.py3-none-any.whl (15 kB)
Collecting yacs
  Downloading yacs-0.1.8-py3-none-any.whl (14 kB)
Requirement already satisfied: opencv-python in /usr/local/lib/python3.8/dist-packages (from gluoncv&lt;0.10.6,&gt;=0.10.5-&gt;autogluon.vision==0.6.1-&gt;autogluon) (4.6.0.66)
Collecting autocfg
  Downloading autocfg-0.0.8-py3-none-any.whl (13 kB)
Requirement already satisfied: pydantic~=1.7 in /usr/local/lib/python3.8/dist-packages (from gluonts~=0.11.0-&gt;autogluon.timeseries[all]==0.6.1-&gt;autogluon) (1.10.2)
Requirement already satisfied: typing-extensions~=4.0 in /usr/local/lib/python3.8/dist-packages (from gluonts~=0.11.0-&gt;autogluon.timeseries[all]==0.6.1-&gt;autogluon) (4.4.0)
Requirement already satisfied: future in /usr/local/lib/python3.8/dist-packages (from hyperopt&lt;0.2.8,&gt;=0.2.7-&gt;autogluon.core[all]==0.6.1-&gt;autogluon) (0.16.0)
Collecting py4j
  Downloading py4j-0.10.9.7-py2.py3-none-any.whl (200 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 200.5/200.5 kB 258.7 MB/s eta 0:00:00
ent already satisfied: importlib-resources&gt;=1.4.0 in /usr/local/lib/python3.8/dist-packages (from jsonschema&lt;=4.8.0-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (5.10.1)
Requirement already satisfied: pyrsistent!=0.17.0,!=0.17.1,!=0.17.2,&gt;=0.14.0 in /usr/local/lib/python3.8/dist-packages (from jsonschema&lt;=4.8.0-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (0.19.2)
Requirement already satisfied: attrs&gt;=17.4.0 in /usr/local/lib/python3.8/dist-packages (from jsonschema&lt;=4.8.0-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (22.1.0)
Requirement already satisfied: wheel in /usr/local/lib/python3.8/dist-packages (from lightgbm&lt;3.4,&gt;=3.3-&gt;autogluon.tabular[all]==0.6.1-&gt;autogluon) (0.38.4)
Requirement already satisfied: regex&gt;=2021.8.3 in /usr/local/lib/python3.8/dist-packages (from nltk&lt;4.0.0,&gt;=3.4.5-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (2022.6.2)
Collecting typish&gt;=1.7.0
  Downloading typish-1.9.3-py3-none-any.whl (45 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 45.1/45.1 kB 178.9 MB/s eta 0:00:00
e==4.8
  Downloading antlr4-python3-runtime-4.8.tar.gz (112 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 112.4/112.4 kB 260.0 MB/s eta 0:00:00
etadata (setup.py) ... odel-index
  Downloading model_index-0.1.11-py3-none-any.whl (34 kB)
Collecting colorama
  Downloading colorama-0.4.6-py2.py3-none-any.whl (25 kB)
Collecting rich
  Downloading rich-13.0.0-py3-none-any.whl (238 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 238.1/238.1 kB 310.5 MB/s eta 0:00:00
ent already satisfied: tabulate in /usr/local/lib/python3.8/dist-packages (from openmim&lt;=0.2.1,&gt;0.1.5-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (0.8.10)
Requirement already satisfied: pytz&gt;=2017.3 in /usr/local/lib/python3.8/dist-packages (from pandas!=1.4.0,&lt;1.6,&gt;=1.2.5-&gt;autogluon.core[all]==0.6.1-&gt;autogluon) (2022.6)
Requirement already satisfied: python-dateutil&gt;=2.7.3 in /usr/local/lib/python3.8/dist-packages (from pandas!=1.4.0,&lt;1.6,&gt;=1.2.5-&gt;autogluon.core[all]==0.6.1-&gt;autogluon) (2.8.2)
Requirement already satisfied: urllib3 in /usr/local/lib/python3.8/dist-packages (from pmdarima~=1.8.2-&gt;autogluon.timeseries[all]==0.6.1-&gt;autogluon) (1.24.3)
Requirement already satisfied: Cython!=0.29.18,&gt;=0.29 in /usr/local/lib/python3.8/dist-packages (from pmdarima~=1.8.2-&gt;autogluon.timeseries[all]==0.6.1-&gt;autogluon) (0.29.32)
Collecting pyDeprecate&gt;=0.3.1
  Downloading pyDeprecate-0.3.2-py3-none-any.whl (10 kB)
Requirement already satisfied: tensorboard&gt;=2.9.1 in /usr/local/lib/python3.8/dist-packages (from pytorch-lightning&lt;1.8.0,&gt;=1.7.4-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (2.9.1)
Requirement already satisfied: frozenlist in /usr/local/lib/python3.8/dist-packages (from ray&lt;2.1,&gt;=2.0-&gt;autogluon.core[all]==0.6.1-&gt;autogluon) (1.3.3)
Collecting grpcio&lt;=1.43.0,&gt;=1.32.0
  Downloading grpcio-1.43.0-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (4.1 MB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4.1/4.1 MB 205.1 MB/s eta 0:00:00
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 8.8/8.8 MB 199.8 MB/s eta 0:00:00
ent already satisfied: filelock in /usr/local/lib/python3.8/dist-packages (from ray&lt;2.1,&gt;=2.0-&gt;autogluon.core[all]==0.6.1-&gt;autogluon) (3.8.2)
Requirement already satisfied: protobuf&lt;4.0.0,&gt;=3.15.3 in /usr/local/lib/python3.8/dist-packages (from ray&lt;2.1,&gt;=2.0-&gt;autogluon.core[all]==0.6.1-&gt;autogluon) (3.19.6)
Requirement already satisfied: aiosignal in /usr/local/lib/python3.8/dist-packages (from ray&lt;2.1,&gt;=2.0-&gt;autogluon.core[all]==0.6.1-&gt;autogluon) (1.3.1)
Collecting tensorboardX&gt;=1.9
  Downloading tensorboardX-2.5.1-py2.py3-none-any.whl (125 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 125.4/125.4 kB 170.0 MB/s eta 0:00:00
ent already satisfied: idna&lt;3,&gt;=2.5 in /usr/local/lib/python3.8/dist-packages (from requests-&gt;autogluon.core[all]==0.6.1-&gt;autogluon) (2.10)
Requirement already satisfied: chardet&lt;4,&gt;=3.0.2 in /usr/local/lib/python3.8/dist-packages (from requests-&gt;autogluon.core[all]==0.6.1-&gt;autogluon) (3.0.4)
Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.8/dist-packages (from requests-&gt;autogluon.core[all]==0.6.1-&gt;autogluon) (2022.12.7)
Requirement already satisfied: tifffile&gt;=2019.7.26 in /usr/local/lib/python3.8/dist-packages (from scikit-image&lt;0.20.0,&gt;=0.19.1-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (2022.10.10)
Requirement already satisfied: imageio&gt;=2.4.1 in /usr/local/lib/python3.8/dist-packages (from scikit-image&lt;0.20.0,&gt;=0.19.1-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (2.9.0)
Requirement already satisfied: PyWavelets&gt;=1.1.1 in /usr/local/lib/python3.8/dist-packages (from scikit-image&lt;0.20.0,&gt;=0.19.1-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (1.4.1)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /usr/local/lib/python3.8/dist-packages (from scikit-learn&lt;1.2,&gt;=1.0.0-&gt;autogluon.core[all]==0.6.1-&gt;autogluon) (3.1.0)
Collecting deprecated&gt;=1.2.13
  Downloading Deprecated-1.2.13-py2.py3-none-any.whl (9.6 kB)
Requirement already satisfied: numba&gt;=0.53 in /usr/local/lib/python3.8/dist-packages (from sktime&lt;0.14,&gt;=0.13.1-&gt;autogluon.timeseries[all]==0.6.1-&gt;autogluon) (0.56.4)
Requirement already satisfied: patsy&gt;=0.5.2 in /usr/local/lib/python3.8/dist-packages (from statsmodels~=0.13.0-&gt;autogluon.timeseries[all]==0.6.1-&gt;autogluon) (0.5.3)
Collecting tokenizers!=0.11.3,&lt;0.14,&gt;=0.11.1
  Downloading tokenizers-0.13.2-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (7.6 MB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 7.6/7.6 MB 38.8 MB/s eta 0:00:00
espath&lt;2.0.0,&gt;=0.7.1
  Downloading jmespath-1.0.1-py3-none-any.whl (20 kB)
Collecting botocore&lt;1.30.0,&gt;=1.29.41
  Downloading botocore-1.29.41-py3-none-any.whl (10.3 MB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 10.3/10.3 MB 162.0 MB/s eta 0:00:00
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 79.6/79.6 kB 166.8 MB/s eta 0:00:00
ent already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.8/dist-packages (from matplotlib-&gt;autogluon.core[all]==0.6.1-&gt;autogluon) (1.4.4)
Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,&gt;=2.0.1 in /usr/local/lib/python3.8/dist-packages (from matplotlib-&gt;autogluon.core[all]==0.6.1-&gt;autogluon) (3.0.9)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.8/dist-packages (from matplotlib-&gt;autogluon.core[all]==0.6.1-&gt;autogluon) (0.11.0)
Collecting urllib3
  Downloading urllib3-1.25.11-py2.py3-none-any.whl (127 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 128.0/128.0 kB 178.2 MB/s eta 0:00:00
ent already satisfied: pyarrow&gt;=6.0.0 in /usr/local/lib/python3.8/dist-packages (from datasets&gt;=2.0.0-&gt;evaluate&lt;=0.3.0-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (9.0.0)
Requirement already satisfied: aiohttp in /usr/local/lib/python3.8/dist-packages (from datasets&gt;=2.0.0-&gt;evaluate&lt;=0.3.0-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (3.8.3)
Requirement already satisfied: wrapt&lt;2,&gt;=1.10 in /usr/local/lib/python3.8/dist-packages (from deprecated&gt;=1.2.13-&gt;sktime&lt;0.14,&gt;=0.13.1-&gt;autogluon.timeseries[all]==0.6.1-&gt;autogluon) (1.14.1)
Requirement already satisfied: zipp&gt;=3.1.0 in /usr/local/lib/python3.8/dist-packages (from importlib-resources&gt;=1.4.0-&gt;jsonschema&lt;=4.8.0-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (3.11.0)
Requirement already satisfied: llvmlite&lt;0.40,&gt;=0.39.0dev0 in /usr/local/lib/python3.8/dist-packages (from numba&gt;=0.53-&gt;sktime&lt;0.14,&gt;=0.13.1-&gt;autogluon.timeseries[all]==0.6.1-&gt;autogluon) (0.39.1)
Requirement already satisfied: importlib-metadata in /usr/local/lib/python3.8/dist-packages (from numba&gt;=0.53-&gt;sktime&lt;0.14,&gt;=0.13.1-&gt;autogluon.timeseries[all]==0.6.1-&gt;autogluon) (5.1.0)
Requirement already satisfied: locket in /usr/local/lib/python3.8/dist-packages (from partd&gt;=0.3.10-&gt;dask&lt;=2021.11.2,&gt;=2021.09.1-&gt;autogluon.core[all]==0.6.1-&gt;autogluon) (1.0.0)
Requirement already satisfied: typer&lt;0.8.0,&gt;=0.3.0 in /usr/local/lib/python3.8/dist-packages (from spacy&lt;4-&gt;fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.6.1-&gt;autogluon) (0.7.0)
Requirement already satisfied: langcodes&lt;4.0.0,&gt;=3.2.0 in /usr/local/lib/python3.8/dist-packages (from spacy&lt;4-&gt;fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.6.1-&gt;autogluon) (3.3.0)
Requirement already satisfied: thinc&lt;8.2.0,&gt;=8.1.0 in /usr/local/lib/python3.8/dist-packages (from spacy&lt;4-&gt;fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.6.1-&gt;autogluon) (8.1.5)
Requirement already satisfied: murmurhash&lt;1.1.0,&gt;=0.28.0 in /usr/local/lib/python3.8/dist-packages (from spacy&lt;4-&gt;fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.6.1-&gt;autogluon) (1.0.9)
Requirement already satisfied: spacy-legacy&lt;3.1.0,&gt;=3.0.10 in /usr/local/lib/python3.8/dist-packages (from spacy&lt;4-&gt;fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.6.1-&gt;autogluon) (3.0.10)
Requirement already satisfied: srsly&lt;3.0.0,&gt;=2.4.3 in /usr/local/lib/python3.8/dist-packages (from spacy&lt;4-&gt;fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.6.1-&gt;autogluon) (2.4.5)
Requirement already satisfied: wasabi&lt;1.1.0,&gt;=0.9.1 in /usr/local/lib/python3.8/dist-packages (from spacy&lt;4-&gt;fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.6.1-&gt;autogluon) (0.10.1)
Requirement already satisfied: spacy-loggers&lt;2.0.0,&gt;=1.0.0 in /usr/local/lib/python3.8/dist-packages (from spacy&lt;4-&gt;fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.6.1-&gt;autogluon) (1.0.4)
Requirement already satisfied: pathy&gt;=0.3.5 in /usr/local/lib/python3.8/dist-packages (from spacy&lt;4-&gt;fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.6.1-&gt;autogluon) (0.10.1)
Requirement already satisfied: cymem&lt;2.1.0,&gt;=2.0.2 in /usr/local/lib/python3.8/dist-packages (from spacy&lt;4-&gt;fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.6.1-&gt;autogluon) (2.0.7)
Requirement already satisfied: preshed&lt;3.1.0,&gt;=3.0.2 in /usr/local/lib/python3.8/dist-packages (from spacy&lt;4-&gt;fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.6.1-&gt;autogluon) (3.0.8)
Requirement already satisfied: catalogue&lt;2.1.0,&gt;=2.0.6 in /usr/local/lib/python3.8/dist-packages (from spacy&lt;4-&gt;fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.6.1-&gt;autogluon) (2.0.8)
Requirement already satisfied: tensorboard-plugin-wit&gt;=1.6.0 in /usr/local/lib/python3.8/dist-packages (from tensorboard&gt;=2.9.1-&gt;pytorch-lightning&lt;1.8.0,&gt;=1.7.4-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (1.8.1)
Requirement already satisfied: werkzeug&gt;=1.0.1 in /usr/local/lib/python3.8/dist-packages (from tensorboard&gt;=2.9.1-&gt;pytorch-lightning&lt;1.8.0,&gt;=1.7.4-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (1.0.1)
Requirement already satisfied: google-auth&lt;3,&gt;=1.6.3 in /usr/local/lib/python3.8/dist-packages (from tensorboard&gt;=2.9.1-&gt;pytorch-lightning&lt;1.8.0,&gt;=1.7.4-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (2.15.0)
Requirement already satisfied: absl-py&gt;=0.4 in /usr/local/lib/python3.8/dist-packages (from tensorboard&gt;=2.9.1-&gt;pytorch-lightning&lt;1.8.0,&gt;=1.7.4-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (1.3.0)
Requirement already satisfied: markdown&gt;=2.6.8 in /usr/local/lib/python3.8/dist-packages (from tensorboard&gt;=2.9.1-&gt;pytorch-lightning&lt;1.8.0,&gt;=1.7.4-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (3.4.1)
Requirement already satisfied: google-auth-oauthlib&lt;0.5,&gt;=0.4.1 in /usr/local/lib/python3.8/dist-packages (from tensorboard&gt;=2.9.1-&gt;pytorch-lightning&lt;1.8.0,&gt;=1.7.4-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (0.4.6)
Requirement already satisfied: tensorboard-data-server&lt;0.7.0,&gt;=0.6.0 in /usr/local/lib/python3.8/dist-packages (from tensorboard&gt;=2.9.1-&gt;pytorch-lightning&lt;1.8.0,&gt;=1.7.4-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (0.6.1)
Requirement already satisfied: heapdict in /usr/local/lib/python3.8/dist-packages (from zict&gt;=0.1.3-&gt;distributed&lt;=2021.11.2,&gt;=2021.09.1-&gt;autogluon.core[all]==0.6.1-&gt;autogluon) (1.0.1)
Requirement already satisfied: MarkupSafe&gt;=0.23 in /usr/local/lib/python3.8/dist-packages (from jinja2-&gt;distributed&lt;=2021.11.2,&gt;=2021.09.1-&gt;autogluon.core[all]==0.6.1-&gt;autogluon) (2.0.1)
Collecting ordered-set
  Downloading ordered_set-4.1.0-py3-none-any.whl (7.6 kB)
Requirement already satisfied: tenacity&gt;=6.2.0 in /usr/local/lib/python3.8/dist-packages (from plotly-&gt;catboost&lt;1.2,&gt;=1.0-&gt;autogluon.tabular[all]==0.6.1-&gt;autogluon) (8.1.0)
Collecting commonmark&lt;0.10.0,&gt;=0.9.0
  Downloading commonmark-0.9.1-py2.py3-none-any.whl (51 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 51.1/51.1 kB 133.7 MB/s eta 0:00:00
ent already satisfied: pygments&lt;3.0.0,&gt;=2.6.0 in /usr/local/lib/python3.8/dist-packages (from rich-&gt;openmim&lt;=0.2.1,&gt;0.1.5-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (2.6.1)
Collecting distlib&lt;1,&gt;=0.3.6
  Downloading distlib-0.3.6-py2.py3-none-any.whl (468 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 468.5/468.5 kB 236.1 MB/s eta 0:00:00
ent already satisfied: platformdirs&lt;3,&gt;=2.4 in /usr/local/lib/python3.8/dist-packages (from virtualenv-&gt;ray&lt;2.1,&gt;=2.0-&gt;autogluon.core[all]==0.6.1-&gt;autogluon) (2.6.0)
Requirement already satisfied: charset-normalizer&lt;3.0,&gt;=2.0 in /usr/local/lib/python3.8/dist-packages (from aiohttp-&gt;datasets&gt;=2.0.0-&gt;evaluate&lt;=0.3.0-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (2.1.1)
Requirement already satisfied: yarl&lt;2.0,&gt;=1.0 in /usr/local/lib/python3.8/dist-packages (from aiohttp-&gt;datasets&gt;=2.0.0-&gt;evaluate&lt;=0.3.0-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (1.8.2)
Requirement already satisfied: async-timeout&lt;5.0,&gt;=4.0.0a3 in /usr/local/lib/python3.8/dist-packages (from aiohttp-&gt;datasets&gt;=2.0.0-&gt;evaluate&lt;=0.3.0-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (4.0.2)
Requirement already satisfied: multidict&lt;7.0,&gt;=4.5 in /usr/local/lib/python3.8/dist-packages (from aiohttp-&gt;datasets&gt;=2.0.0-&gt;evaluate&lt;=0.3.0-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (6.0.3)
Requirement already satisfied: rsa&lt;5,&gt;=3.1.4 in /usr/local/lib/python3.8/dist-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&gt;=2.9.1-&gt;pytorch-lightning&lt;1.8.0,&gt;=1.7.4-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (4.9)
Requirement already satisfied: pyasn1-modules&gt;=0.2.1 in /usr/local/lib/python3.8/dist-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&gt;=2.9.1-&gt;pytorch-lightning&lt;1.8.0,&gt;=1.7.4-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (0.2.8)
Requirement already satisfied: cachetools&lt;6.0,&gt;=2.0.0 in /usr/local/lib/python3.8/dist-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&gt;=2.9.1-&gt;pytorch-lightning&lt;1.8.0,&gt;=1.7.4-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (5.2.0)
Requirement already satisfied: requests-oauthlib&gt;=0.7.0 in /usr/local/lib/python3.8/dist-packages (from google-auth-oauthlib&lt;0.5,&gt;=0.4.1-&gt;tensorboard&gt;=2.9.1-&gt;pytorch-lightning&lt;1.8.0,&gt;=1.7.4-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (1.3.1)
Requirement already satisfied: blis&lt;0.8.0,&gt;=0.7.8 in /usr/local/lib/python3.8/dist-packages (from thinc&lt;8.2.0,&gt;=8.1.0-&gt;spacy&lt;4-&gt;fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.6.1-&gt;autogluon) (0.7.9)
Requirement already satisfied: confection&lt;1.0.0,&gt;=0.0.1 in /usr/local/lib/python3.8/dist-packages (from thinc&lt;8.2.0,&gt;=8.1.0-&gt;spacy&lt;4-&gt;fastai&lt;2.8,&gt;=2.3.1-&gt;autogluon.tabular[all]==0.6.1-&gt;autogluon) (0.0.3)
Requirement already satisfied: pyasn1&lt;0.5.0,&gt;=0.4.6 in /usr/local/lib/python3.8/dist-packages (from pyasn1-modules&gt;=0.2.1-&gt;google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&gt;=2.9.1-&gt;pytorch-lightning&lt;1.8.0,&gt;=1.7.4-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (0.4.8)
Requirement already satisfied: oauthlib&gt;=3.0.0 in /usr/local/lib/python3.8/dist-packages (from requests-oauthlib&gt;=0.7.0-&gt;google-auth-oauthlib&lt;0.5,&gt;=0.4.1-&gt;tensorboard&gt;=2.9.1-&gt;pytorch-lightning&lt;1.8.0,&gt;=1.7.4-&gt;autogluon.multimodal==0.6.1-&gt;autogluon) (3.2.2)
Building wheels for collected packages: fairscale, antlr4-python3-runtime, seqeval
  Building wheel for fairscale (pyproject.toml) ... e=fairscale-0.4.6-py3-none-any.whl size=307224 sha256=a2367f45f3681dabd5d17fda61f95bea3269033289e30d7730fe402559e92269
  Stored in directory: /tmp/pip-ephem-wheel-cache-tr2vs4wn/wheels/60/e8/f1/4f2cc869823c35e834c6cee0552a0605c2bdc89f7da81f1a1d
  Building wheel for antlr4-python3-runtime (setup.py) ... e: filename=antlr4_python3_runtime-4.8-py3-none-any.whl size=141211 sha256=f79ccdf859e58f9b924ef31dbb2da3292e991259b54a7fa4c6613ac4e27e5be1
  Stored in directory: /tmp/pip-ephem-wheel-cache-tr2vs4wn/wheels/34/d7/fe/a833ceccaee881c6f8cd49985ee4285bf94c5cf2c66ea5db68
  Building wheel for seqeval (setup.py) ... e=seqeval-1.2.2-py3-none-any.whl size=16164 sha256=d917965c03fb6ff3e7516c9afc19fca6bd86ccbda2ab83bc1101fa133aff8959
  Stored in directory: /tmp/pip-ephem-wheel-cache-tr2vs4wn/wheels/e3/30/9b/6b670dac34775f2b7cc4e9b172202e81fbb4f9cdb103c1ca66
Successfully built fairscale antlr4-python3-runtime seqeval
Installing collected packages: typish, tokenizers, sentencepiece, py4j, distlib, commonmark, antlr4-python3-runtime, yacs, xxhash, virtualenv, urllib3, torch, tensorboardX, smart-open, rich, pyDeprecate, psutil, portalocker, Pillow, ordered-set, omegaconf, nptyping, multiprocess, jmespath, grpcio, deprecated, colorama, autocfg, xgboost, torchmetrics, hyperopt, fairscale, dask, botocore, accelerate, torchvision, torchtext, statsmodels, seqeval, scikit-image, s3transfer, responses, ray, nlpaug, model-index, lightgbm, huggingface-hub, gluonts, gluoncv, distributed, catboost, transformers, timm, sktime, pytorch-metric-learning, pmdarima, openmim, datasets, boto3, albumentations, tbats, evaluate, autogluon.common, pytorch-lightning, autogluon.features, autogluon.core, autogluon.tabular, autogluon.multimodal, autogluon.vision, autogluon.timeseries, autogluon.text, autogluon
  Attempting uninstall: urllib3
    Found existing installation: urllib3 1.24.3
    Uninstalling urllib3-1.24.3:
      Successfully uninstalled urllib3-1.24.3
  Attempting uninstall: torch
    Found existing installation: torch 1.13.0+cu116
    Uninstalling torch-1.13.0+cu116:
      Successfully uninstalled torch-1.13.0+cu116
  Attempting uninstall: smart-open
    Found existing installation: smart-open 6.3.0
    Uninstalling smart-open-6.3.0:
      Successfully uninstalled smart-open-6.3.0
  Attempting uninstall: psutil
    Found existing installation: psutil 5.4.8
    Uninstalling psutil-5.4.8:
      Successfully uninstalled psutil-5.4.8
  Attempting uninstall: Pillow
    Found existing installation: Pillow 7.1.2
    Uninstalling Pillow-7.1.2:
      Successfully uninstalled Pillow-7.1.2
  Attempting uninstall: grpcio
    Found existing installation: grpcio 1.51.1
    Uninstalling grpcio-1.51.1:
      Successfully uninstalled grpcio-1.51.1
  Attempting uninstall: xgboost
    Found existing installation: xgboost 0.90
    Uninstalling xgboost-0.90:
      Successfully uninstalled xgboost-0.90
  Attempting uninstall: hyperopt
    Found existing installation: hyperopt 0.1.2
    Uninstalling hyperopt-0.1.2:
      Successfully uninstalled hyperopt-0.1.2
  Attempting uninstall: dask
    Found existing installation: dask 2022.2.1
    Uninstalling dask-2022.2.1:
      Successfully uninstalled dask-2022.2.1
  Attempting uninstall: torchvision
    Found existing installation: torchvision 0.14.0+cu116
    Uninstalling torchvision-0.14.0+cu116:
      Successfully uninstalled torchvision-0.14.0+cu116
  Attempting uninstall: torchtext
    Found existing installation: torchtext 0.14.0
    Uninstalling torchtext-0.14.0:
      Successfully uninstalled torchtext-0.14.0
  Attempting uninstall: statsmodels
    Found existing installation: statsmodels 0.12.2
    Uninstalling statsmodels-0.12.2:
      Successfully uninstalled statsmodels-0.12.2
  Attempting uninstall: scikit-image
    Found existing installation: scikit-image 0.18.3
    Uninstalling scikit-image-0.18.3:
      Successfully uninstalled scikit-image-0.18.3
  Attempting uninstall: lightgbm
    Found existing installation: lightgbm 2.2.3
    Uninstalling lightgbm-2.2.3:
      Successfully uninstalled lightgbm-2.2.3
  Attempting uninstall: distributed
    Found existing installation: distributed 2022.2.1
    Uninstalling distributed-2022.2.1:
      Successfully uninstalled distributed-2022.2.1
  Attempting uninstall: albumentations
    Found existing installation: albumentations 1.2.1
    Uninstalling albumentations-1.2.1:
      Successfully uninstalled albumentations-1.2.1
ERROR: pip&#39;s dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
torchaudio 0.13.0+cu116 requires torch==1.13.0, but you have torch 1.12.1 which is incompatible.
panel 0.12.1 requires bokeh&lt;2.4.0,&gt;=2.3.0, but you have bokeh 2.0.1 which is incompatible.
grpcio-status 1.48.2 requires grpcio&gt;=1.48.2, but you have grpcio 1.43.0 which is incompatible.
google-cloud-bigquery 3.3.6 requires grpcio&lt;2.0dev,&gt;=1.47.0, but you have grpcio 1.43.0 which is incompatible.
Successfully installed Pillow-9.3.0 accelerate-0.13.2 albumentations-1.1.0 antlr4-python3-runtime-4.8 autocfg-0.0.8 autogluon-0.6.1 autogluon.common-0.6.1 autogluon.core-0.6.1 autogluon.features-0.6.1 autogluon.multimodal-0.6.1 autogluon.tabular-0.6.1 autogluon.text-0.6.1 autogluon.timeseries-0.6.1 autogluon.vision-0.6.1 boto3-1.26.41 botocore-1.29.41 catboost-1.1.1 colorama-0.4.6 commonmark-0.9.1 dask-2021.11.2 datasets-2.8.0 deprecated-1.2.13 distlib-0.3.6 distributed-2021.11.2 evaluate-0.3.0 fairscale-0.4.6 gluoncv-0.10.5.post0 gluonts-0.11.6 grpcio-1.43.0 huggingface-hub-0.11.1 hyperopt-0.2.7 jmespath-1.0.1 lightgbm-3.3.3 model-index-0.1.11 multiprocess-0.70.14 nlpaug-1.1.10 nptyping-1.4.4 omegaconf-2.1.2 openmim-0.2.1 ordered-set-4.1.0 pmdarima-1.8.5 portalocker-2.6.0 psutil-5.8.0 py4j-0.10.9.7 pyDeprecate-0.3.2 pytorch-lightning-1.7.7 pytorch-metric-learning-1.3.2 ray-2.0.1 responses-0.18.0 rich-13.0.0 s3transfer-0.6.0 scikit-image-0.19.3 sentencepiece-0.1.97 seqeval-1.2.2 sktime-0.13.4 smart-open-5.2.1 statsmodels-0.13.5 tbats-1.1.2 tensorboardX-2.5.1 timm-0.6.12 tokenizers-0.13.2 torch-1.12.1 torchmetrics-0.8.2 torchtext-0.13.1 torchvision-0.13.1 transformers-4.23.1 typish-1.9.3 urllib3-1.25.11 virtualenv-20.17.1 xgboost-1.7.2 xxhash-3.2.0 yacs-0.1.8
WARNING: Running pip as the &#39;root&#39; user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv
</code></pre>
</div>
</div>
<section id="setup-kaggle-api-key" class="cell markdown"
id="6Zl1cgIj6CdE">
<h3>Setup Kaggle API Key</h3>
</section>
<div class="cell code" data-execution_count="3" id="mg0RYWQ16CDz">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create the .kaggle directory and an empty kaggle.json file</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>mkdir <span class="op">-</span>p <span class="op">/</span>root<span class="op">/</span>.kaggle</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>touch <span class="op">/</span>root<span class="op">/</span>.kaggle<span class="op">/</span>kaggle.json</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>chmod <span class="dv">600</span> <span class="op">/</span>root<span class="op">/</span>.kaggle<span class="op">/</span>kaggle.json</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="4" id="xd3Cv6S16ZjI">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>kaggle_username <span class="op">=</span> <span class="st">&quot;mohsenm95&quot;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>kaggle_key <span class="op">=</span> <span class="st">&quot;b17fcefff7ca1ce81c28a08d08165cbd&quot;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Save API token the kaggle.json file</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">&quot;/root/.kaggle/kaggle.json&quot;</span>, <span class="st">&quot;w&quot;</span>) <span class="im">as</span> f:</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    f.write(json.dumps({<span class="st">&quot;username&quot;</span>: kaggle_username, <span class="st">&quot;key&quot;</span>: kaggle_key}))</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="5"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="PZzEHcfk6xDS" data-outputId="3f4a840a-340a-4dd6-c3af-5e4769c4f0b2">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>kaggle competitions download <span class="op">-</span>c bike<span class="op">-</span>sharing<span class="op">-</span>demand</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>unzip <span class="op">-</span>o bike<span class="op">-</span>sharing<span class="op">-</span>demand.<span class="bu">zip</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>Downloading bike-sharing-demand.zip to /content
100% 189k/189k [00:00&lt;00:00, 749kB/s]
100% 189k/189k [00:00&lt;00:00, 748kB/s]
Archive:  bike-sharing-demand.zip
  inflating: sampleSubmission.csv    
  inflating: test.csv                
  inflating: train.csv               
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="6" id="b2u9Ofrg7CgY">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="38"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
id="AO0akf8s7E48" data-outputId="3f0e6663-fab8-4a6d-949d-587838ee78cb">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the train dataset in pandas by reading the csv</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the parsing of the datetime column so, you can use some `dt` features in pandas later</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> pd.read_csv(<span class="st">&#39;train.csv&#39;</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>train.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="38">

  <div id="df-5ff96475-11d7-4566-98b2-bc0e3bb7a42d">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>season</th>
      <th>holiday</th>
      <th>workingday</th>
      <th>weather</th>
      <th>temp</th>
      <th>atemp</th>
      <th>humidity</th>
      <th>windspeed</th>
      <th>casual</th>
      <th>registered</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2011-01-01 00:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.84</td>
      <td>14.395</td>
      <td>81</td>
      <td>0.0</td>
      <td>3</td>
      <td>13</td>
      <td>16</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2011-01-01 01:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.02</td>
      <td>13.635</td>
      <td>80</td>
      <td>0.0</td>
      <td>8</td>
      <td>32</td>
      <td>40</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2011-01-01 02:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.02</td>
      <td>13.635</td>
      <td>80</td>
      <td>0.0</td>
      <td>5</td>
      <td>27</td>
      <td>32</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2011-01-01 03:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.84</td>
      <td>14.395</td>
      <td>75</td>
      <td>0.0</td>
      <td>3</td>
      <td>10</td>
      <td>13</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2011-01-01 04:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.84</td>
      <td>14.395</td>
      <td>75</td>
      <td>0.0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-5ff96475-11d7-4566-98b2-bc0e3bb7a42d')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-5ff96475-11d7-4566-98b2-bc0e3bb7a42d button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-5ff96475-11d7-4566-98b2-bc0e3bb7a42d');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="39"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:364}"
id="YjfVjOnd7FkF" data-outputId="b1d9cdd4-2c27-4204-af6a-4518ccba8e76">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simple output of the train dataset to view some min/max/variation of the dataset features.</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>train.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="39">

  <div id="df-a868e1ee-6f3d-42a1-b40e-3294544b01a1">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>season</th>
      <th>holiday</th>
      <th>workingday</th>
      <th>weather</th>
      <th>temp</th>
      <th>atemp</th>
      <th>humidity</th>
      <th>windspeed</th>
      <th>casual</th>
      <th>registered</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.00000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
      <td>10886.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2.506614</td>
      <td>0.028569</td>
      <td>0.680875</td>
      <td>1.418427</td>
      <td>20.23086</td>
      <td>23.655084</td>
      <td>61.886460</td>
      <td>12.799395</td>
      <td>36.021955</td>
      <td>155.552177</td>
      <td>191.574132</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.116174</td>
      <td>0.166599</td>
      <td>0.466159</td>
      <td>0.633839</td>
      <td>7.79159</td>
      <td>8.474601</td>
      <td>19.245033</td>
      <td>8.164537</td>
      <td>49.960477</td>
      <td>151.039033</td>
      <td>181.144454</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.82000</td>
      <td>0.760000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>13.94000</td>
      <td>16.665000</td>
      <td>47.000000</td>
      <td>7.001500</td>
      <td>4.000000</td>
      <td>36.000000</td>
      <td>42.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>3.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>20.50000</td>
      <td>24.240000</td>
      <td>62.000000</td>
      <td>12.998000</td>
      <td>17.000000</td>
      <td>118.000000</td>
      <td>145.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>4.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>26.24000</td>
      <td>31.060000</td>
      <td>77.000000</td>
      <td>16.997900</td>
      <td>49.000000</td>
      <td>222.000000</td>
      <td>284.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>4.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>4.000000</td>
      <td>41.00000</td>
      <td>45.455000</td>
      <td>100.000000</td>
      <td>56.996900</td>
      <td>367.000000</td>
      <td>886.000000</td>
      <td>977.000000</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-a868e1ee-6f3d-42a1-b40e-3294544b01a1')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-a868e1ee-6f3d-42a1-b40e-3294544b01a1 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-a868e1ee-6f3d-42a1-b40e-3294544b01a1');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="40"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
id="4yMoWC6m7NlK" data-outputId="745197d4-8d8a-444c-a08a-d50a725ba9b3">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the test pandas dataframe in pandas by reading the csv, remember to parse the datetime!</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> pd.read_csv(<span class="st">&#39;test.csv&#39;</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>test.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="40">

  <div id="df-179b74b6-aa2c-45a4-ad75-cd007b456b63">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>season</th>
      <th>holiday</th>
      <th>workingday</th>
      <th>weather</th>
      <th>temp</th>
      <th>atemp</th>
      <th>humidity</th>
      <th>windspeed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2011-01-20 00:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>10.66</td>
      <td>11.365</td>
      <td>56</td>
      <td>26.0027</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2011-01-20 01:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>10.66</td>
      <td>13.635</td>
      <td>56</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2011-01-20 02:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>10.66</td>
      <td>13.635</td>
      <td>56</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2011-01-20 03:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>10.66</td>
      <td>12.880</td>
      <td>56</td>
      <td>11.0014</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2011-01-20 04:00:00</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>10.66</td>
      <td>12.880</td>
      <td>56</td>
      <td>11.0014</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-179b74b6-aa2c-45a4-ad75-cd007b456b63')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-179b74b6-aa2c-45a4-ad75-cd007b456b63 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-179b74b6-aa2c-45a4-ad75-cd007b456b63');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="41"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
id="YDGAG8G87PHd" data-outputId="aaf0546d-dc3a-4266-c92a-c8c2844f2363">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Same thing as train and test dataset</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>submission <span class="op">=</span> pd.read_csv(<span class="st">&#39;sampleSubmission.csv&#39;</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>submission.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="41">

  <div id="df-35f74b0c-0a9e-4333-b61c-a55b9c352ffd">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2011-01-20 00:00:00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2011-01-20 01:00:00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2011-01-20 02:00:00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2011-01-20 03:00:00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2011-01-20 04:00:00</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-35f74b0c-0a9e-4333-b61c-a55b9c352ffd')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-35f74b0c-0a9e-4333-b61c-a55b9c352ffd button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-35f74b0c-0a9e-4333-b61c-a55b9c352ffd');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<section id="step-3-train-a-model-using-autogluons-tabular-prediction"
class="cell markdown" id="Na6T4y0f7gBC">
<h2>Step 3: Train a model using AutoGluon’s Tabular Prediction</h2>
</section>
<div class="cell markdown" id="7IRiotxt8CxE">
<p>Requirements:</p>
<ul>
<li>We are prediting <code>count</code>, so it is the label we are
setting.</li>
<li>Ignore <code>casual</code> and <code>registered</code> columns as
they are also not present in the test dataset.</li>
<li>Use the <code>root_mean_squared_error</code> as the metric to use
for evaluation.</li>
<li>Set a time limit of 10 minutes (600 seconds).</li>
<li>Use the preset <code>best_quality</code> to focus on creating the
best model.</li>
</ul>
</div>
<div class="cell code" data-execution_count="42" id="FEX80ebj7hJj">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> train.drop(columns<span class="op">=</span>[<span class="st">&#39;casual&#39;</span>, <span class="st">&#39;registered&#39;</span>])</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="43"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="_PaqJtaQ8H2R" data-outputId="086bc335-f03e-485d-a7bb-8a8e65acacc5">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    label <span class="op">=</span> <span class="st">&quot;count&quot;</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    problem_type <span class="op">=</span> <span class="st">&quot;regression&quot;</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    eval_metric <span class="op">=</span> <span class="st">&quot;root_mean_squared_error&quot;</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>).fit(</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    train_data <span class="op">=</span> train,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    time_limit <span class="op">=</span> <span class="dv">600</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    presets <span class="op">=</span> <span class="st">&quot;best_quality&quot;</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>No path specified. Models will be saved in: &quot;AutogluonModels/ag-20230101_063352/&quot;
Presets specified: [&#39;best_quality&#39;]
Stack configuration (auto_stack=True): num_stack_levels=1, num_bag_folds=8, num_bag_sets=20
Beginning AutoGluon training ... Time limit = 600s
AutoGluon will save models to &quot;AutogluonModels/ag-20230101_063352/&quot;
AutoGluon Version:  0.6.1
Python Version:     3.8.16
Operating System:   Linux
Platform Machine:   x86_64
Platform Version:   #1 SMP Fri Aug 26 08:44:51 UTC 2022
Train Data Rows:    10886
Train Data Columns: 9
Label Column: count
Preprocessing data ...
Using Feature Generators to preprocess the data ...
Fitting AutoMLPipelineFeatureGenerator...
	Available Memory:                    11070.41 MB
	Train Data (Original)  Memory Usage: 1.52 MB (0.0% of available memory)
	Inferring data type of each feature based on column values. Set feature_metadata_in to manually specify special dtypes of the features.
	Stage 1 Generators:
		Fitting AsTypeFeatureGenerator...
			Note: Converting 2 features to boolean dtype as they only contain 2 unique values.
	Stage 2 Generators:
		Fitting FillNaFeatureGenerator...
	Stage 3 Generators:
		Fitting IdentityFeatureGenerator...
		Fitting DatetimeFeatureGenerator...
/usr/local/lib/python3.8/dist-packages/autogluon/features/generators/datetime.py:59: FutureWarning: casting datetime64[ns, UTC] values to int64 with .astype(...) is deprecated and will raise in a future version. Use .view(...) instead.
  good_rows = series[~series.isin(bad_rows)].astype(np.int64)
	Stage 4 Generators:
		Fitting DropUniqueFeatureGenerator...
	Types of features in original data (raw dtype, special dtypes):
		(&#39;float&#39;, [])                      : 3 | [&#39;temp&#39;, &#39;atemp&#39;, &#39;windspeed&#39;]
		(&#39;int&#39;, [])                        : 5 | [&#39;season&#39;, &#39;holiday&#39;, &#39;workingday&#39;, &#39;weather&#39;, &#39;humidity&#39;]
		(&#39;object&#39;, [&#39;datetime_as_object&#39;]) : 1 | [&#39;datetime&#39;]
	Types of features in processed data (raw dtype, special dtypes):
		(&#39;float&#39;, [])                : 3 | [&#39;temp&#39;, &#39;atemp&#39;, &#39;windspeed&#39;]
		(&#39;int&#39;, [])                  : 3 | [&#39;season&#39;, &#39;weather&#39;, &#39;humidity&#39;]
		(&#39;int&#39;, [&#39;bool&#39;])            : 2 | [&#39;holiday&#39;, &#39;workingday&#39;]
		(&#39;int&#39;, [&#39;datetime_as_int&#39;]) : 5 | [&#39;datetime&#39;, &#39;datetime.year&#39;, &#39;datetime.month&#39;, &#39;datetime.day&#39;, &#39;datetime.dayofweek&#39;]
	0.3s = Fit runtime
	9 features in original data used to generate 13 features in processed data.
	Train Data (Processed) Memory Usage: 0.98 MB (0.0% of available memory)
Data preprocessing and feature engineering runtime = 0.38s ...
AutoGluon will gauge predictive performance using evaluation metric: &#39;root_mean_squared_error&#39;
	This metric&#39;s sign has been flipped to adhere to being higher_is_better. The metric score can be multiplied by -1 to get the metric value.
	To change this, specify the eval_metric parameter of Predictor()
AutoGluon will fit 2 stack levels (L1 to L2) ...
Fitting 11 L1 models ...
Fitting model: KNeighborsUnif_BAG_L1 ... Training model for up to 399.65s of the 599.62s of remaining time.
	-101.5462	 = Validation score   (-root_mean_squared_error)
	0.04s	 = Training   runtime
	0.04s	 = Validation runtime
Fitting model: KNeighborsDist_BAG_L1 ... Training model for up to 399.52s of the 599.49s of remaining time.
	-84.1251	 = Validation score   (-root_mean_squared_error)
	0.04s	 = Training   runtime
	0.05s	 = Validation runtime
Fitting model: LightGBMXT_BAG_L1 ... Training model for up to 399.38s of the 599.35s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-131.4609	 = Validation score   (-root_mean_squared_error)
	61.67s	 = Training   runtime
	13.23s	 = Validation runtime
Fitting model: LightGBM_BAG_L1 ... Training model for up to 330.47s of the 530.44s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-131.0542	 = Validation score   (-root_mean_squared_error)
	25.78s	 = Training   runtime
	0.99s	 = Validation runtime
Fitting model: RandomForestMSE_BAG_L1 ... Training model for up to 300.03s of the 500.0s of remaining time.
	-116.5443	 = Validation score   (-root_mean_squared_error)
	10.47s	 = Training   runtime
	0.53s	 = Validation runtime
Fitting model: CatBoost_BAG_L1 ... Training model for up to 288.36s of the 488.33s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-130.4961	 = Validation score   (-root_mean_squared_error)
	214.38s	 = Training   runtime
	0.11s	 = Validation runtime
Fitting model: ExtraTreesMSE_BAG_L1 ... Training model for up to 70.25s of the 270.22s of remaining time.
	-124.5881	 = Validation score   (-root_mean_squared_error)
	4.66s	 = Training   runtime
	0.51s	 = Validation runtime
Fitting model: NeuralNetFastAI_BAG_L1 ... Training model for up to 64.19s of the 264.16s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-138.4934	 = Validation score   (-root_mean_squared_error)
	69.31s	 = Training   runtime
	0.38s	 = Validation runtime
Completed 1/20 k-fold bagging repeats ...
Fitting model: WeightedEnsemble_L2 ... Training model for up to 360.0s of the 191.23s of remaining time.
	-84.1251	 = Validation score   (-root_mean_squared_error)
	0.37s	 = Training   runtime
	0.0s	 = Validation runtime
Fitting 9 L2 models ...
Fitting model: LightGBMXT_BAG_L2 ... Training model for up to 190.83s of the 190.81s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-60.137	 = Validation score   (-root_mean_squared_error)
	43.64s	 = Training   runtime
	2.83s	 = Validation runtime
Fitting model: LightGBM_BAG_L2 ... Training model for up to 142.46s of the 142.44s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-55.0059	 = Validation score   (-root_mean_squared_error)
	25.71s	 = Training   runtime
	0.24s	 = Validation runtime
Fitting model: RandomForestMSE_BAG_L2 ... Training model for up to 113.02s of the 113.01s of remaining time.
	-53.3236	 = Validation score   (-root_mean_squared_error)
	28.19s	 = Training   runtime
	0.65s	 = Validation runtime
Fitting model: CatBoost_BAG_L2 ... Training model for up to 83.59s of the 83.58s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-55.6979	 = Validation score   (-root_mean_squared_error)
	68.8s	 = Training   runtime
	0.06s	 = Validation runtime
Fitting model: ExtraTreesMSE_BAG_L2 ... Training model for up to 11.06s of the 11.04s of remaining time.
	-54.0325	 = Validation score   (-root_mean_squared_error)
	7.97s	 = Training   runtime
	0.65s	 = Validation runtime
Fitting model: NeuralNetFastAI_BAG_L2 ... Training model for up to 1.78s of the 1.76s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	Time limit exceeded... Skipping NeuralNetFastAI_BAG_L2.
2023-01-01 06:43:56,813	ERROR worker.py:399 -- Unhandled error (suppress with &#39;RAY_IGNORE_UNHANDLED_ERRORS=1&#39;): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
Completed 1/20 k-fold bagging repeats ...
Fitting model: WeightedEnsemble_L3 ... Training model for up to 360.0s of the -4.54s of remaining time.
	-52.835	 = Validation score   (-root_mean_squared_error)
	0.43s	 = Training   runtime
	0.0s	 = Validation runtime
AutoGluon training complete, total runtime = 605.05s ... Best model: &quot;WeightedEnsemble_L3&quot;
TabularPredictor saved. To load, use: predictor = TabularPredictor.load(&quot;AutogluonModels/ag-20230101_063352/&quot;)
</code></pre>
</div>
</div>
<section
id="review-autogluons-training-run-with-ranking-of-models-that-did-the-best"
class="cell markdown" id="Ej0r8P9O8Kzh">
<h3>Review AutoGluon's training run with ranking of models that did the
best.</h3>
</section>
<div class="cell code" data-execution_count="44"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="TyE-fHP18Mgl" data-outputId="7abec670-a53f-450a-a495-dda539982f7d">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>predictor.fit_summary()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>*** Summary of fit() ***
Estimated performance of each model:
                     model   score_val  pred_time_val    fit_time  pred_time_val_marginal  fit_time_marginal  stack_level  can_infer  fit_order
0      WeightedEnsemble_L3  -52.835046      17.431302  517.457853                0.001134           0.432165            3       True         15
1   RandomForestMSE_BAG_L2  -53.323642      16.488791  414.543897                0.650382          28.188541            2       True         12
2     ExtraTreesMSE_BAG_L2  -54.032512      16.484182  394.325898                0.645773           7.970543            2       True         14
3          LightGBM_BAG_L2  -55.005870      16.075361  412.062018                0.236952          25.706662            2       True         11
4          CatBoost_BAG_L2  -55.697910      15.897062  455.159943                0.058653          68.804587            2       True         13
5        LightGBMXT_BAG_L2  -60.136965      18.665762  429.996201                2.827353          43.640845            2       True         10
6    KNeighborsDist_BAG_L1  -84.125061       0.046328    0.039483                0.046328           0.039483            1       True          2
7      WeightedEnsemble_L2  -84.125061       0.047388    0.407407                0.001060           0.367924            2       True          9
8    KNeighborsUnif_BAG_L1 -101.546199       0.037057    0.044590                0.037057           0.044590            1       True          1
9   RandomForestMSE_BAG_L1 -116.544294       0.528364   10.468781                0.528364          10.468781            1       True          5
10    ExtraTreesMSE_BAG_L1 -124.588053       0.512047    4.660942                0.512047           4.660942            1       True          7
11         CatBoost_BAG_L1 -130.496065       0.111918  214.380699                0.111918         214.380699            1       True          6
12         LightGBM_BAG_L1 -131.054162       0.987064   25.776013                0.987064          25.776013            1       True          4
13       LightGBMXT_BAG_L1 -131.460909      13.231149   61.669936               13.231149          61.669936            1       True          3
14  NeuralNetFastAI_BAG_L1 -138.493409       0.384482   69.314913                0.384482          69.314913            1       True          8
Number of models trained: 15
Types of models trained:
{&#39;StackerEnsembleModel_CatBoost&#39;, &#39;StackerEnsembleModel_NNFastAiTabular&#39;, &#39;StackerEnsembleModel_LGB&#39;, &#39;WeightedEnsembleModel&#39;, &#39;StackerEnsembleModel_RF&#39;, &#39;StackerEnsembleModel_XT&#39;, &#39;StackerEnsembleModel_KNN&#39;}
Bagging used: True  (with 8 folds)
Multi-layer stack-ensembling used: True  (with 3 levels)
Feature Metadata (Processed):
(raw dtype, special dtypes):
(&#39;float&#39;, [])                : 3 | [&#39;temp&#39;, &#39;atemp&#39;, &#39;windspeed&#39;]
(&#39;int&#39;, [])                  : 3 | [&#39;season&#39;, &#39;weather&#39;, &#39;humidity&#39;]
(&#39;int&#39;, [&#39;bool&#39;])            : 2 | [&#39;holiday&#39;, &#39;workingday&#39;]
(&#39;int&#39;, [&#39;datetime_as_int&#39;]) : 5 | [&#39;datetime&#39;, &#39;datetime.year&#39;, &#39;datetime.month&#39;, &#39;datetime.day&#39;, &#39;datetime.dayofweek&#39;]
Plot summary of models saved to file: AutogluonModels/ag-20230101_063352/SummaryOfModels.html
*** End of fit() summary ***
</code></pre>
</div>
<div class="output execute_result" data-execution_count="44">
<pre><code>{&#39;model_types&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: &#39;StackerEnsembleModel_KNN&#39;,
  &#39;KNeighborsDist_BAG_L1&#39;: &#39;StackerEnsembleModel_KNN&#39;,
  &#39;LightGBMXT_BAG_L1&#39;: &#39;StackerEnsembleModel_LGB&#39;,
  &#39;LightGBM_BAG_L1&#39;: &#39;StackerEnsembleModel_LGB&#39;,
  &#39;RandomForestMSE_BAG_L1&#39;: &#39;StackerEnsembleModel_RF&#39;,
  &#39;CatBoost_BAG_L1&#39;: &#39;StackerEnsembleModel_CatBoost&#39;,
  &#39;ExtraTreesMSE_BAG_L1&#39;: &#39;StackerEnsembleModel_XT&#39;,
  &#39;NeuralNetFastAI_BAG_L1&#39;: &#39;StackerEnsembleModel_NNFastAiTabular&#39;,
  &#39;WeightedEnsemble_L2&#39;: &#39;WeightedEnsembleModel&#39;,
  &#39;LightGBMXT_BAG_L2&#39;: &#39;StackerEnsembleModel_LGB&#39;,
  &#39;LightGBM_BAG_L2&#39;: &#39;StackerEnsembleModel_LGB&#39;,
  &#39;RandomForestMSE_BAG_L2&#39;: &#39;StackerEnsembleModel_RF&#39;,
  &#39;CatBoost_BAG_L2&#39;: &#39;StackerEnsembleModel_CatBoost&#39;,
  &#39;ExtraTreesMSE_BAG_L2&#39;: &#39;StackerEnsembleModel_XT&#39;,
  &#39;WeightedEnsemble_L3&#39;: &#39;WeightedEnsembleModel&#39;},
 &#39;model_performance&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: -101.54619908446061,
  &#39;KNeighborsDist_BAG_L1&#39;: -84.12506123181602,
  &#39;LightGBMXT_BAG_L1&#39;: -131.46090891834504,
  &#39;LightGBM_BAG_L1&#39;: -131.054161598899,
  &#39;RandomForestMSE_BAG_L1&#39;: -116.54429428704391,
  &#39;CatBoost_BAG_L1&#39;: -130.49606504460496,
  &#39;ExtraTreesMSE_BAG_L1&#39;: -124.58805258915959,
  &#39;NeuralNetFastAI_BAG_L1&#39;: -138.49340923778672,
  &#39;WeightedEnsemble_L2&#39;: -84.12506123181602,
  &#39;LightGBMXT_BAG_L2&#39;: -60.136964933308505,
  &#39;LightGBM_BAG_L2&#39;: -55.00586972129759,
  &#39;RandomForestMSE_BAG_L2&#39;: -53.32364225688556,
  &#39;CatBoost_BAG_L2&#39;: -55.69790977780722,
  &#39;ExtraTreesMSE_BAG_L2&#39;: -54.03251226320859,
  &#39;WeightedEnsemble_L3&#39;: -52.835045913752055},
 &#39;model_best&#39;: &#39;WeightedEnsemble_L3&#39;,
 &#39;model_paths&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_063352/models/KNeighborsUnif_BAG_L1/&#39;,
  &#39;KNeighborsDist_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_063352/models/KNeighborsDist_BAG_L1/&#39;,
  &#39;LightGBMXT_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_063352/models/LightGBMXT_BAG_L1/&#39;,
  &#39;LightGBM_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_063352/models/LightGBM_BAG_L1/&#39;,
  &#39;RandomForestMSE_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_063352/models/RandomForestMSE_BAG_L1/&#39;,
  &#39;CatBoost_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_063352/models/CatBoost_BAG_L1/&#39;,
  &#39;ExtraTreesMSE_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_063352/models/ExtraTreesMSE_BAG_L1/&#39;,
  &#39;NeuralNetFastAI_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_063352/models/NeuralNetFastAI_BAG_L1/&#39;,
  &#39;WeightedEnsemble_L2&#39;: &#39;AutogluonModels/ag-20230101_063352/models/WeightedEnsemble_L2/&#39;,
  &#39;LightGBMXT_BAG_L2&#39;: &#39;AutogluonModels/ag-20230101_063352/models/LightGBMXT_BAG_L2/&#39;,
  &#39;LightGBM_BAG_L2&#39;: &#39;AutogluonModels/ag-20230101_063352/models/LightGBM_BAG_L2/&#39;,
  &#39;RandomForestMSE_BAG_L2&#39;: &#39;AutogluonModels/ag-20230101_063352/models/RandomForestMSE_BAG_L2/&#39;,
  &#39;CatBoost_BAG_L2&#39;: &#39;AutogluonModels/ag-20230101_063352/models/CatBoost_BAG_L2/&#39;,
  &#39;ExtraTreesMSE_BAG_L2&#39;: &#39;AutogluonModels/ag-20230101_063352/models/ExtraTreesMSE_BAG_L2/&#39;,
  &#39;WeightedEnsemble_L3&#39;: &#39;AutogluonModels/ag-20230101_063352/models/WeightedEnsemble_L3/&#39;},
 &#39;model_fit_times&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: 0.04458951950073242,
  &#39;KNeighborsDist_BAG_L1&#39;: 0.039482831954956055,
  &#39;LightGBMXT_BAG_L1&#39;: 61.669936418533325,
  &#39;LightGBM_BAG_L1&#39;: 25.776012897491455,
  &#39;RandomForestMSE_BAG_L1&#39;: 10.468780994415283,
  &#39;CatBoost_BAG_L1&#39;: 214.38069868087769,
  &#39;ExtraTreesMSE_BAG_L1&#39;: 4.6609416007995605,
  &#39;NeuralNetFastAI_BAG_L1&#39;: 69.31491279602051,
  &#39;WeightedEnsemble_L2&#39;: 0.3679237365722656,
  &#39;LightGBMXT_BAG_L2&#39;: 43.64084529876709,
  &#39;LightGBM_BAG_L2&#39;: 25.70666241645813,
  &#39;RandomForestMSE_BAG_L2&#39;: 28.188540935516357,
  &#39;CatBoost_BAG_L2&#39;: 68.80458688735962,
  &#39;ExtraTreesMSE_BAG_L2&#39;: 7.970542669296265,
  &#39;WeightedEnsemble_L3&#39;: 0.43216466903686523},
 &#39;model_pred_times&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: 0.03705739974975586,
  &#39;KNeighborsDist_BAG_L1&#39;: 0.04632830619812012,
  &#39;LightGBMXT_BAG_L1&#39;: 13.231148958206177,
  &#39;LightGBM_BAG_L1&#39;: 0.9870636463165283,
  &#39;RandomForestMSE_BAG_L1&#39;: 0.5283641815185547,
  &#39;CatBoost_BAG_L1&#39;: 0.11191797256469727,
  &#39;ExtraTreesMSE_BAG_L1&#39;: 0.5120465755462646,
  &#39;NeuralNetFastAI_BAG_L1&#39;: 0.38448238372802734,
  &#39;WeightedEnsemble_L2&#39;: 0.0010600090026855469,
  &#39;LightGBMXT_BAG_L2&#39;: 2.827352523803711,
  &#39;LightGBM_BAG_L2&#39;: 0.2369518280029297,
  &#39;RandomForestMSE_BAG_L2&#39;: 0.6503815650939941,
  &#39;CatBoost_BAG_L2&#39;: 0.058652639389038086,
  &#39;ExtraTreesMSE_BAG_L2&#39;: 0.6457726955413818,
  &#39;WeightedEnsemble_L3&#39;: 0.0011336803436279297},
 &#39;num_bag_folds&#39;: 8,
 &#39;max_stack_level&#39;: 3,
 &#39;model_hyperparams&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;KNeighborsDist_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;LightGBMXT_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;LightGBM_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;RandomForestMSE_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;CatBoost_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;ExtraTreesMSE_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;NeuralNetFastAI_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;WeightedEnsemble_L2&#39;: {&#39;use_orig_features&#39;: False,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;LightGBMXT_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;LightGBM_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;RandomForestMSE_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;CatBoost_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;ExtraTreesMSE_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;WeightedEnsemble_L3&#39;: {&#39;use_orig_features&#39;: False,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True}},
 &#39;leaderboard&#39;:                      model   score_val  pred_time_val    fit_time  \
 0      WeightedEnsemble_L3  -52.835046      17.431302  517.457853   
 1   RandomForestMSE_BAG_L2  -53.323642      16.488791  414.543897   
 2     ExtraTreesMSE_BAG_L2  -54.032512      16.484182  394.325898   
 3          LightGBM_BAG_L2  -55.005870      16.075361  412.062018   
 4          CatBoost_BAG_L2  -55.697910      15.897062  455.159943   
 5        LightGBMXT_BAG_L2  -60.136965      18.665762  429.996201   
 6    KNeighborsDist_BAG_L1  -84.125061       0.046328    0.039483   
 7      WeightedEnsemble_L2  -84.125061       0.047388    0.407407   
 8    KNeighborsUnif_BAG_L1 -101.546199       0.037057    0.044590   
 9   RandomForestMSE_BAG_L1 -116.544294       0.528364   10.468781   
 10    ExtraTreesMSE_BAG_L1 -124.588053       0.512047    4.660942   
 11         CatBoost_BAG_L1 -130.496065       0.111918  214.380699   
 12         LightGBM_BAG_L1 -131.054162       0.987064   25.776013   
 13       LightGBMXT_BAG_L1 -131.460909      13.231149   61.669936   
 14  NeuralNetFastAI_BAG_L1 -138.493409       0.384482   69.314913   
 
     pred_time_val_marginal  fit_time_marginal  stack_level  can_infer  \
 0                 0.001134           0.432165            3       True   
 1                 0.650382          28.188541            2       True   
 2                 0.645773           7.970543            2       True   
 3                 0.236952          25.706662            2       True   
 4                 0.058653          68.804587            2       True   
 5                 2.827353          43.640845            2       True   
 6                 0.046328           0.039483            1       True   
 7                 0.001060           0.367924            2       True   
 8                 0.037057           0.044590            1       True   
 9                 0.528364          10.468781            1       True   
 10                0.512047           4.660942            1       True   
 11                0.111918         214.380699            1       True   
 12                0.987064          25.776013            1       True   
 13               13.231149          61.669936            1       True   
 14                0.384482          69.314913            1       True   
 
     fit_order  
 0          15  
 1          12  
 2          14  
 3          11  
 4          13  
 5          10  
 6           2  
 7           9  
 8           1  
 9           5  
 10          7  
 11          6  
 12          4  
 13          3  
 14          8  }</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="45"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:426}"
id="OAWjrYY2JeCS" data-outputId="cba92862-91cb-4298-eced-e677839269da">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>predictor.leaderboard(silent<span class="op">=</span><span class="va">True</span>).plot(kind<span class="op">=</span><span class="st">&quot;bar&quot;</span>, x<span class="op">=</span><span class="st">&quot;model&quot;</span>, y<span class="op">=</span><span class="st">&quot;score_val&quot;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="45">
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f17da56d2b0&gt;</code></pre>
</div>
<div class="output display_data">
<p><img
src="./img/leaderboard_01.png" /></p>
</div>
</div>
<section id="create-predictions-from-test-dataset" class="cell markdown"
id="HCBPyyg38RpV">
<h3>Create predictions from test dataset</h3>
</section>
<div class="cell code" data-execution_count="46"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="dwiItZZ68Sed" data-outputId="5be54f93-ba4c-43ff-bc89-07d1569d1472">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> predictor.predict(test)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>predictions.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="46">
<pre><code>0    23.918108
1    41.809868
2    45.174591
3    48.650589
4    51.392319
Name: count, dtype: float32</code></pre>
</div>
</div>
<section
id="note-kaggle-will-reject-the-submission-if-we-dont-set-everything-to-be--0"
class="cell markdown" id="7GOh3OQ58UhV">
<h4>NOTE: Kaggle will reject the submission if we don't set everything
to be &gt; 0.</h4>
</section>
<div class="cell code" data-execution_count="47"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="vkYLLr6l8aFG" data-outputId="5fd25ea4-c664-43d9-d69e-e9954b652c67">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Describe the `predictions` series to see if there are any negative values</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">any</span>(predictions<span class="op">&lt;</span><span class="dv">0</span>))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>False
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="48"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="FOtKzq-G8cej" data-outputId="538402a2-acde-4a1c-b07d-4c5893df1891">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># How many negative values do we have?</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>predictions.lt(<span class="dv">0</span>).<span class="bu">sum</span>().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="48">
<pre><code>0</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="49" id="4qUg4BGT8c7k">
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set them to zero</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>predictions[predictions <span class="op">&lt;</span> <span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span></span></code></pre></div>
</div>
<section id="set-predictions-to-submission-dataframe-save-and-submit"
class="cell markdown" id="uVo5DkpK8gdm">
<h3>Set predictions to submission dataframe, save, and submit</h3>
</section>
<div class="cell code" data-execution_count="50" id="Z-c6bJN-8hTY">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>submission[<span class="st">&quot;count&quot;</span>] <span class="op">=</span> predictions</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>submission.to_csv(<span class="st">&quot;submission.csv&quot;</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="51"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="ziRrqdnJ8kkr" data-outputId="de309e5b-55f5-4da0-f435-a63914ce8a3b">
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>kaggle competitions submit <span class="op">-</span>c bike<span class="op">-</span>sharing<span class="op">-</span>demand <span class="op">-</span>f submission.csv <span class="op">-</span>m <span class="st">&quot;first raw submission&quot;</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>100% 188k/188k [00:00&lt;00:00, 200kB/s]
Successfully submitted to Bike Sharing Demand</code></pre>
</div>
</div>
<section
id="view-submission-via-the-command-line-or-in-the-web-browser-under-the-competitions-page---my-submissions"
class="cell markdown" id="6KVEHwXs8ndG">
<h4>View submission via the command line or in the web browser under the
competition's page - <code>My Submissions</code></h4>
</section>
<div class="cell code" data-execution_count="52"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="Zs0koUd-8oO0" data-outputId="9dbac224-06d5-4cfb-b2c6-28b9dd39f8da">
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>kaggle competitions submissions <span class="op">-</span>c bike<span class="op">-</span>sharing<span class="op">-</span>demand <span class="op">|</span> tail <span class="op">-</span>n <span class="op">+</span><span class="dv">1</span> <span class="op">|</span> head <span class="op">-</span>n <span class="dv">6</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>fileName                     date                 description                        status    publicScore  privateScore  
---------------------------  -------------------  ---------------------------------  --------  -----------  ------------  
submission.csv               2023-01-01 06:47:24  first raw submission               complete  1.80654      1.80654       
submission.csv               2023-01-01 06:21:25  first raw submission               complete  0.46659      0.46659       
submission_new_hpo.csv       2022-12-31 19:29:29  new features with hyperparameters  complete  0.52633      0.52633       
submission_new_hpo.csv       2022-12-31 19:05:33  new features with hyperparameters  complete  0.53261      0.53261       
</code></pre>
</div>
</div>
<section id="initial-score-of-179580" class="cell markdown"
id="fns1rjcL8qEs">
<h4>Initial score of 1.79580</h4>
</section>
<section
id="step-4-exploratory-data-analysis-and-creating-an-additional-feature"
class="cell markdown" id="pKm4F1Oq9Gne">
<h2>Step 4: Exploratory Data Analysis and Creating an additional
feature</h2>
<ul>
<li>Any additional feature will do, but a great suggestion would be to
separate out the datetime into hour, day, or month parts.</li>
</ul>
</section>
<div class="cell code" data-execution_count="53"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:660}"
id="-rX0V5iP1H8t" data-outputId="83bcd120-aa28-4cdd-880c-4ce673cbd161">
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">35</span>,<span class="dv">20</span>))</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">1</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;datetime&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>plt.hist(train[<span class="st">&#39;datetime&#39;</span>])</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">2</span>)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;season&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>plt.hist(train[<span class="st">&#39;season&#39;</span>])</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">3</span>)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;holiday&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>plt.hist(train[<span class="st">&#39;holiday&#39;</span>])</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">4</span>)</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;workingday&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>plt.hist(train[<span class="st">&#39;workingday&#39;</span>])</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">5</span>)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;weather&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>plt.hist(train[<span class="st">&#39;weather&#39;</span>])</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">6</span>)</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;temp&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>plt.hist(train[<span class="st">&#39;temp&#39;</span>])</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">7</span>)</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;atemp&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>plt.hist(train[<span class="st">&#39;atemp&#39;</span>])</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">8</span>)</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;humidity&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>plt.hist(train[<span class="st">&#39;humidity&#39;</span>])</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">9</span>)</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;windspeed&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>plt.hist(train[<span class="st">&#39;windspeed&#39;</span>])</span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;count&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>plt.hist(train[<span class="st">&#39;count&#39;</span>])</span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="./img/features_before_eda.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="54" id="toZD1VcnIe9U">
<div class="sourceCode" id="cb33"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a new feature</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>train[<span class="st">&#39;datetime&#39;</span>] <span class="op">=</span> pd.to_datetime(train[<span class="st">&#39;datetime&#39;</span>])</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>train[<span class="st">&#39;year&#39;</span>] <span class="op">=</span> train[<span class="st">&#39;datetime&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.year)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>train[<span class="st">&#39;month&#39;</span>] <span class="op">=</span> train[<span class="st">&#39;datetime&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.month)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>train[<span class="st">&#39;day&#39;</span>] <span class="op">=</span> train[<span class="st">&#39;datetime&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.day)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>train[<span class="st">&#39;hour&#39;</span>] <span class="op">=</span> train[<span class="st">&#39;datetime&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.hour)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>train[<span class="st">&#39;minute&#39;</span>] <span class="op">=</span> train[<span class="st">&#39;datetime&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.minute)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>train[<span class="st">&#39;second&#39;</span>] <span class="op">=</span> train[<span class="st">&#39;datetime&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.second)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> train.drop(columns<span class="op">=</span>[<span class="st">&#39;datetime&#39;</span>])</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>test[<span class="st">&#39;datetime&#39;</span>] <span class="op">=</span> pd.to_datetime(test[<span class="st">&#39;datetime&#39;</span>])</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>test[<span class="st">&#39;year&#39;</span>] <span class="op">=</span> test[<span class="st">&#39;datetime&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.year)</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>test[<span class="st">&#39;month&#39;</span>] <span class="op">=</span> test[<span class="st">&#39;datetime&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.month)</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>test[<span class="st">&#39;day&#39;</span>] <span class="op">=</span> test[<span class="st">&#39;datetime&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.day)</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>test[<span class="st">&#39;hour&#39;</span>] <span class="op">=</span> test[<span class="st">&#39;datetime&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.hour)</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>test[<span class="st">&#39;minute&#39;</span>] <span class="op">=</span> test[<span class="st">&#39;datetime&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.minute)</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>test[<span class="st">&#39;second&#39;</span>] <span class="op">=</span> test[<span class="st">&#39;datetime&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.second)</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> test.drop(columns<span class="op">=</span>[<span class="st">&#39;datetime&#39;</span>])</span></code></pre></div>
</div>
<section
id="make-category-types-for-these-so-models-know-they-are-not-just-numbers"
class="cell markdown" id="cmrneYXLIhxD">
<h2>Make category types for these so models know they are not just
numbers</h2>
<ul>
<li>AutoGluon originally sees these as ints, but in reality they are int
representations of a category.</li>
<li>Setting the dtype to category will classify these as categories in
AutoGluon.</li>
</ul>
</section>
<div class="cell code" data-execution_count="55" id="BBlOwam9IkvV">
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>encoded_df <span class="op">=</span> pd.get_dummies(train[<span class="st">&#39;season&#39;</span>], prefix<span class="op">=</span><span class="st">&#39;season&#39;</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> pd.concat([train, encoded_df], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> train.drop(columns<span class="op">=</span>[<span class="st">&#39;season&#39;</span>])</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>encoded_df <span class="op">=</span> pd.get_dummies(train[<span class="st">&#39;weather&#39;</span>], prefix<span class="op">=</span><span class="st">&#39;weather&#39;</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> pd.concat([train, encoded_df], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> train.drop(columns<span class="op">=</span>[<span class="st">&#39;weather&#39;</span>])</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>encoded_df <span class="op">=</span> pd.get_dummies(test[<span class="st">&#39;season&#39;</span>], prefix<span class="op">=</span><span class="st">&#39;season&#39;</span>)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> pd.concat([test, encoded_df], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> test.drop(columns<span class="op">=</span>[<span class="st">&#39;season&#39;</span>])</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>encoded_df <span class="op">=</span> pd.get_dummies(test[<span class="st">&#39;weather&#39;</span>], prefix<span class="op">=</span><span class="st">&#39;weather&#39;</span>)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> pd.concat([test, encoded_df], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> test.drop(columns<span class="op">=</span>[<span class="st">&#39;weather&#39;</span>])</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="56" id="sziG5eubUDtK">
<div class="sourceCode" id="cb35"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>temp_scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>train[<span class="st">&#39;temp&#39;</span>] <span class="op">=</span> temp_scaler.fit_transform(np.array(train[<span class="st">&#39;temp&#39;</span>]).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>atemp_scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>train[<span class="st">&#39;atemp&#39;</span>] <span class="op">=</span> atemp_scaler.fit_transform(np.array(train[<span class="st">&#39;atemp&#39;</span>]).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>humidity_scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>train[<span class="st">&#39;humidity&#39;</span>] <span class="op">=</span> humidity_scaler.fit_transform(np.array(train[<span class="st">&#39;humidity&#39;</span>]).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>windspeed_scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>train[<span class="st">&#39;windspeed&#39;</span>] <span class="op">=</span> windspeed_scaler.fit_transform(np.array(train[<span class="st">&#39;windspeed&#39;</span>]).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>test[<span class="st">&#39;temp&#39;</span>] <span class="op">=</span> temp_scaler.transform(np.array(test[<span class="st">&#39;temp&#39;</span>]).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>test[<span class="st">&#39;atemp&#39;</span>] <span class="op">=</span> atemp_scaler.transform(np.array(test[<span class="st">&#39;atemp&#39;</span>]).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>test[<span class="st">&#39;humidity&#39;</span>] <span class="op">=</span> humidity_scaler.transform(np.array(test[<span class="st">&#39;humidity&#39;</span>]).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>test[<span class="st">&#39;windspeed&#39;</span>] <span class="op">=</span> windspeed_scaler.transform(np.array(test[<span class="st">&#39;windspeed&#39;</span>]).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="57"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:300}"
id="EKCxAIG5ImeL" data-outputId="90df8e3d-a832-4f1a-eced-4adec854e682">
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View are new feature</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>train.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="57">

  <div id="df-98fd80c9-6c03-4be5-8c14-9288f0730809">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>holiday</th>
      <th>workingday</th>
      <th>temp</th>
      <th>atemp</th>
      <th>humidity</th>
      <th>windspeed</th>
      <th>count</th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
      <th>...</th>
      <th>minute</th>
      <th>second</th>
      <th>season_1</th>
      <th>season_2</th>
      <th>season_3</th>
      <th>season_4</th>
      <th>weather_1</th>
      <th>weather_2</th>
      <th>weather_3</th>
      <th>weather_4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>-1.333661</td>
      <td>-1.092737</td>
      <td>0.993213</td>
      <td>-1.567754</td>
      <td>16</td>
      <td>2011</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>-1.438907</td>
      <td>-1.182421</td>
      <td>0.941249</td>
      <td>-1.567754</td>
      <td>40</td>
      <td>2011</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>-1.438907</td>
      <td>-1.182421</td>
      <td>0.941249</td>
      <td>-1.567754</td>
      <td>32</td>
      <td>2011</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>-1.333661</td>
      <td>-1.092737</td>
      <td>0.681430</td>
      <td>-1.567754</td>
      <td>13</td>
      <td>2011</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>-1.333661</td>
      <td>-1.092737</td>
      <td>0.681430</td>
      <td>-1.567754</td>
      <td>1</td>
      <td>2011</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 21 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-98fd80c9-6c03-4be5-8c14-9288f0730809')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-98fd80c9-6c03-4be5-8c14-9288f0730809 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-98fd80c9-6c03-4be5-8c14-9288f0730809');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="58"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:661}"
id="2DgzePpXIoCk" data-outputId="bb4b4614-be79-4b5b-f161-ba5cd19fe0ca">
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">35</span>,<span class="dv">20</span>))</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">1</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;holiday&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>plt.hist(train[<span class="st">&#39;holiday&#39;</span>])</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">2</span>)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;workingday&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>plt.hist(train[<span class="st">&#39;workingday&#39;</span>])</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">3</span>)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;temp&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>plt.hist(train[<span class="st">&#39;temp&#39;</span>])</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">4</span>)</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;atemp&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>plt.hist(train[<span class="st">&#39;atemp&#39;</span>])</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>)</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;humidity&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>plt.hist(train[<span class="st">&#39;humidity&#39;</span>])</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">6</span>)</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;windspeed&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>plt.hist(train[<span class="st">&#39;windspeed&#39;</span>])</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">7</span>)</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;count&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>plt.hist(train[<span class="st">&#39;count&#39;</span>])</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">8</span>)</span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;year&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>plt.hist(train[<span class="st">&#39;year&#39;</span>])</span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">9</span>)</span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;month&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>plt.hist(train[<span class="st">&#39;month&#39;</span>])</span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;day&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a>plt.hist(train[<span class="st">&#39;day&#39;</span>])</span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">11</span>)</span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;hour&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb37-45"><a href="#cb37-45" aria-hidden="true" tabindex="-1"></a>plt.hist(train[<span class="st">&#39;hour&#39;</span>])</span>
<span id="cb37-46"><a href="#cb37-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-47"><a href="#cb37-47" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">12</span>)</span>
<span id="cb37-48"><a href="#cb37-48" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;minute&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb37-49"><a href="#cb37-49" aria-hidden="true" tabindex="-1"></a>plt.hist(train[<span class="st">&#39;minute&#39;</span>])</span>
<span id="cb37-50"><a href="#cb37-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-51"><a href="#cb37-51" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">13</span>)</span>
<span id="cb37-52"><a href="#cb37-52" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;second&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb37-53"><a href="#cb37-53" aria-hidden="true" tabindex="-1"></a>plt.hist(train[<span class="st">&#39;second&#39;</span>])</span>
<span id="cb37-54"><a href="#cb37-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-55"><a href="#cb37-55" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">14</span>)</span>
<span id="cb37-56"><a href="#cb37-56" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;season_1&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb37-57"><a href="#cb37-57" aria-hidden="true" tabindex="-1"></a>plt.hist(train[<span class="st">&#39;season_1&#39;</span>])</span>
<span id="cb37-58"><a href="#cb37-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-59"><a href="#cb37-59" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">15</span>)</span>
<span id="cb37-60"><a href="#cb37-60" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;season_2&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb37-61"><a href="#cb37-61" aria-hidden="true" tabindex="-1"></a>plt.hist(train[<span class="st">&#39;season_2&#39;</span>])</span>
<span id="cb37-62"><a href="#cb37-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-63"><a href="#cb37-63" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">16</span>)</span>
<span id="cb37-64"><a href="#cb37-64" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;season_3&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb37-65"><a href="#cb37-65" aria-hidden="true" tabindex="-1"></a>plt.hist(train[<span class="st">&#39;season_3&#39;</span>])</span>
<span id="cb37-66"><a href="#cb37-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-67"><a href="#cb37-67" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">17</span>)</span>
<span id="cb37-68"><a href="#cb37-68" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;season_4&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb37-69"><a href="#cb37-69" aria-hidden="true" tabindex="-1"></a>plt.hist(train[<span class="st">&#39;season_4&#39;</span>])</span>
<span id="cb37-70"><a href="#cb37-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-71"><a href="#cb37-71" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">18</span>)</span>
<span id="cb37-72"><a href="#cb37-72" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;weather_1&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb37-73"><a href="#cb37-73" aria-hidden="true" tabindex="-1"></a>plt.hist(train[<span class="st">&#39;weather_1&#39;</span>])</span>
<span id="cb37-74"><a href="#cb37-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-75"><a href="#cb37-75" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">19</span>)</span>
<span id="cb37-76"><a href="#cb37-76" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;weather_2&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb37-77"><a href="#cb37-77" aria-hidden="true" tabindex="-1"></a>plt.hist(train[<span class="st">&#39;weather_2&#39;</span>])</span>
<span id="cb37-78"><a href="#cb37-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-79"><a href="#cb37-79" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">20</span>)</span>
<span id="cb37-80"><a href="#cb37-80" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;weather_3&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb37-81"><a href="#cb37-81" aria-hidden="true" tabindex="-1"></a>plt.hist(train[<span class="st">&#39;weather_3&#39;</span>])</span>
<span id="cb37-82"><a href="#cb37-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-83"><a href="#cb37-83" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">21</span>)</span>
<span id="cb37-84"><a href="#cb37-84" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;weather_4&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb37-85"><a href="#cb37-85" aria-hidden="true" tabindex="-1"></a>plt.hist(train[<span class="st">&#39;weather_4&#39;</span>])</span>
<span id="cb37-86"><a href="#cb37-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-87"><a href="#cb37-87" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="./img/features_after_eda.png" /></p>
</div>
</div>
<section
id="step-5-rerun-the-model-with-the-same-settings-as-before-just-with-more-features"
class="cell markdown" id="T3iP5k6yIqYN">
<h2>Step 5: Rerun the model with the same settings as before, just with
more features</h2>
</section>
<div class="cell code" data-execution_count="59"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="9_KA4oZsIs0l" data-outputId="7e9a5734-4e18-460d-f531-fc4d9b8a18f9">
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>predictor_new_features <span class="op">=</span> TabularPredictor(</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    label <span class="op">=</span> <span class="st">&quot;count&quot;</span>,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    problem_type <span class="op">=</span> <span class="st">&quot;regression&quot;</span>,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    eval_metric <span class="op">=</span> <span class="st">&quot;root_mean_squared_error&quot;</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  ).fit(</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>      train_data <span class="op">=</span> train,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>      time_limit <span class="op">=</span> <span class="dv">600</span>,</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>      presets <span class="op">=</span> <span class="st">&quot;best_quality&quot;</span>   </span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<div class="output stream stderr">
<pre><code>No path specified. Models will be saved in: &quot;AutogluonModels/ag-20230101_065005/&quot;
Presets specified: [&#39;best_quality&#39;]
Stack configuration (auto_stack=True): num_stack_levels=1, num_bag_folds=8, num_bag_sets=20
Beginning AutoGluon training ... Time limit = 600s
AutoGluon will save models to &quot;AutogluonModels/ag-20230101_065005/&quot;
AutoGluon Version:  0.6.1
Python Version:     3.8.16
Operating System:   Linux
Platform Machine:   x86_64
Platform Version:   #1 SMP Fri Aug 26 08:44:51 UTC 2022
Train Data Rows:    10886
Train Data Columns: 20
Label Column: count
Preprocessing data ...
Using Feature Generators to preprocess the data ...
Fitting AutoMLPipelineFeatureGenerator...
	Available Memory:                    10812.86 MB
	Train Data (Original)  Memory Usage: 1.13 MB (0.0% of available memory)
	Inferring data type of each feature based on column values. Set feature_metadata_in to manually specify special dtypes of the features.
	Stage 1 Generators:
		Fitting AsTypeFeatureGenerator...
			Note: Converting 11 features to boolean dtype as they only contain 2 unique values.
	Stage 2 Generators:
		Fitting FillNaFeatureGenerator...
	Stage 3 Generators:
		Fitting IdentityFeatureGenerator...
	Stage 4 Generators:
		Fitting DropUniqueFeatureGenerator...
	Useless Original Features (Count: 2): [&#39;minute&#39;, &#39;second&#39;]
		These features carry no predictive signal and should be manually investigated.
		This is typically a feature which has the same value for all rows.
		These features do not need to be present at inference time.
	Types of features in original data (raw dtype, special dtypes):
		(&#39;float&#39;, []) :  4 | [&#39;temp&#39;, &#39;atemp&#39;, &#39;humidity&#39;, &#39;windspeed&#39;]
		(&#39;int&#39;, [])   : 14 | [&#39;holiday&#39;, &#39;workingday&#39;, &#39;year&#39;, &#39;month&#39;, &#39;day&#39;, ...]
	Types of features in processed data (raw dtype, special dtypes):
		(&#39;float&#39;, [])     :  4 | [&#39;temp&#39;, &#39;atemp&#39;, &#39;humidity&#39;, &#39;windspeed&#39;]
		(&#39;int&#39;, [])       :  3 | [&#39;month&#39;, &#39;day&#39;, &#39;hour&#39;]
		(&#39;int&#39;, [&#39;bool&#39;]) : 11 | [&#39;holiday&#39;, &#39;workingday&#39;, &#39;year&#39;, &#39;season_1&#39;, &#39;season_2&#39;, ...]
	0.1s = Fit runtime
	18 features in original data used to generate 18 features in processed data.
	Train Data (Processed) Memory Usage: 0.73 MB (0.0% of available memory)
Data preprocessing and feature engineering runtime = 0.19s ...
AutoGluon will gauge predictive performance using evaluation metric: &#39;root_mean_squared_error&#39;
	This metric&#39;s sign has been flipped to adhere to being higher_is_better. The metric score can be multiplied by -1 to get the metric value.
	To change this, specify the eval_metric parameter of Predictor()
AutoGluon will fit 2 stack levels (L1 to L2) ...
Fitting 11 L1 models ...
Fitting model: KNeighborsUnif_BAG_L1 ... Training model for up to 399.77s of the 599.8s of remaining time.
	-89.967	 = Validation score   (-root_mean_squared_error)
	0.04s	 = Training   runtime
	0.08s	 = Validation runtime
Fitting model: KNeighborsDist_BAG_L1 ... Training model for up to 399.6s of the 599.62s of remaining time.
	-88.2342	 = Validation score   (-root_mean_squared_error)
	0.03s	 = Training   runtime
	0.09s	 = Validation runtime
Fitting model: LightGBMXT_BAG_L1 ... Training model for up to 399.43s of the 599.46s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-37.4465	 = Validation score   (-root_mean_squared_error)
	85.24s	 = Training   runtime
	24.56s	 = Validation runtime
Fitting model: LightGBM_BAG_L1 ... Training model for up to 310.13s of the 510.16s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-37.8742	 = Validation score   (-root_mean_squared_error)
	42.2s	 = Training   runtime
	3.52s	 = Validation runtime
Fitting model: RandomForestMSE_BAG_L1 ... Training model for up to 262.99s of the 463.02s of remaining time.
	-42.249	 = Validation score   (-root_mean_squared_error)
	10.08s	 = Training   runtime
	0.55s	 = Validation runtime
Fitting model: CatBoost_BAG_L1 ... Training model for up to 251.73s of the 451.76s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-37.4184	 = Validation score   (-root_mean_squared_error)
	216.0s	 = Training   runtime
	0.19s	 = Validation runtime
Fitting model: ExtraTreesMSE_BAG_L1 ... Training model for up to 32.07s of the 232.1s of remaining time.
	-41.5681	 = Validation score   (-root_mean_squared_error)
	9.48s	 = Training   runtime
	0.77s	 = Validation runtime
Fitting model: NeuralNetFastAI_BAG_L1 ... Training model for up to 20.95s of the 220.98s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-106.6625	 = Validation score   (-root_mean_squared_error)
	43.0s	 = Training   runtime
	0.43s	 = Validation runtime
Completed 1/20 k-fold bagging repeats ...
Fitting model: WeightedEnsemble_L2 ... Training model for up to 360.0s of the 173.21s of remaining time.
	-35.9333	 = Validation score   (-root_mean_squared_error)
	0.37s	 = Training   runtime
	0.0s	 = Validation runtime
Fitting 9 L2 models ...
Fitting model: LightGBMXT_BAG_L2 ... Training model for up to 172.82s of the 172.8s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-36.8071	 = Validation score   (-root_mean_squared_error)
	21.1s	 = Training   runtime
	0.2s	 = Validation runtime
Fitting model: LightGBM_BAG_L2 ... Training model for up to 146.8s of the 146.79s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-36.2904	 = Validation score   (-root_mean_squared_error)
	24.72s	 = Training   runtime
	0.1s	 = Validation runtime
Fitting model: RandomForestMSE_BAG_L2 ... Training model for up to 116.42s of the 116.41s of remaining time.
	-36.4959	 = Validation score   (-root_mean_squared_error)
	27.59s	 = Training   runtime
	0.66s	 = Validation runtime
Fitting model: CatBoost_BAG_L2 ... Training model for up to 87.59s of the 87.58s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-35.9346	 = Validation score   (-root_mean_squared_error)
	33.12s	 = Training   runtime
	0.06s	 = Validation runtime
Fitting model: ExtraTreesMSE_BAG_L2 ... Training model for up to 50.76s of the 50.74s of remaining time.
	-36.1444	 = Validation score   (-root_mean_squared_error)
	12.17s	 = Training   runtime
	0.65s	 = Validation runtime
Fitting model: NeuralNetFastAI_BAG_L2 ... Training model for up to 37.25s of the 37.23s of remaining time.
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	-36.7205	 = Validation score   (-root_mean_squared_error)
	51.31s	 = Training   runtime
	0.5s	 = Validation runtime
Completed 1/20 k-fold bagging repeats ...
Fitting model: WeightedEnsemble_L3 ... Training model for up to 360.0s of the -18.34s of remaining time.
	-35.6796	 = Validation score   (-root_mean_squared_error)
	0.37s	 = Training   runtime
	0.0s	 = Validation runtime
AutoGluon training complete, total runtime = 618.76s ... Best model: &quot;WeightedEnsemble_L3&quot;
TabularPredictor saved. To load, use: predictor = TabularPredictor.load(&quot;AutogluonModels/ag-20230101_065005/&quot;)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="60"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="bRb8um8JIteR" data-outputId="9eb11847-ec1b-4f75-9291-7f3bdf0cd251">
<div class="sourceCode" id="cb40"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>predictor_new_features.fit_summary()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>*** Summary of fit() ***
Estimated performance of each model:
                     model   score_val  pred_time_val    fit_time  pred_time_val_marginal  fit_time_marginal  stack_level  can_infer  fit_order
0      WeightedEnsemble_L3  -35.679647      32.168507  555.355923                0.001269           0.372600            3       True         16
1      WeightedEnsemble_L2  -35.933275      29.681589  363.405744                0.000965           0.370219            2       True          9
2          CatBoost_BAG_L2  -35.934630      30.246565  439.188678                0.057654          33.117415            2       True         13
3     ExtraTreesMSE_BAG_L2  -36.144358      30.841286  418.239038                0.652375          12.167774            2       True         14
4          LightGBM_BAG_L2  -36.290443      30.291283  430.794765                0.102371          24.723502            2       True         11
5   RandomForestMSE_BAG_L2  -36.495899      30.852794  433.666075                0.663883          27.594812            2       True         12
6   NeuralNetFastAI_BAG_L2  -36.720480      30.690954  457.379821                0.502043          51.308558            2       True         15
7        LightGBMXT_BAG_L2  -36.807054      30.393583  427.169184                0.204671          21.097921            2       True         10
8          CatBoost_BAG_L1  -37.418358       0.190007  216.002512                0.190007         216.002512            1       True          6
9        LightGBMXT_BAG_L1  -37.446513      24.563971   85.244061               24.563971          85.244061            1       True          3
10         LightGBM_BAG_L1  -37.874227       3.523055   42.201160                3.523055          42.201160            1       True          4
11    ExtraTreesMSE_BAG_L1  -41.568073       0.768466    9.480875                0.768466           9.480875            1       True          7
12  RandomForestMSE_BAG_L1  -42.249030       0.548163   10.076409                0.548163          10.076409            1       True          5
13   KNeighborsDist_BAG_L1  -88.234166       0.086962    0.030508                0.086962           0.030508            1       True          2
14   KNeighborsUnif_BAG_L1  -89.966956       0.076683    0.036536                0.076683           0.036536            1       True          1
15  NeuralNetFastAI_BAG_L1 -106.662461       0.431604   42.999203                0.431604          42.999203            1       True          8
Number of models trained: 16
Types of models trained:
{&#39;StackerEnsembleModel_CatBoost&#39;, &#39;StackerEnsembleModel_NNFastAiTabular&#39;, &#39;StackerEnsembleModel_LGB&#39;, &#39;WeightedEnsembleModel&#39;, &#39;StackerEnsembleModel_RF&#39;, &#39;StackerEnsembleModel_XT&#39;, &#39;StackerEnsembleModel_KNN&#39;}
Bagging used: True  (with 8 folds)
Multi-layer stack-ensembling used: True  (with 3 levels)
Feature Metadata (Processed):
(raw dtype, special dtypes):
(&#39;float&#39;, [])     :  4 | [&#39;temp&#39;, &#39;atemp&#39;, &#39;humidity&#39;, &#39;windspeed&#39;]
(&#39;int&#39;, [])       :  3 | [&#39;month&#39;, &#39;day&#39;, &#39;hour&#39;]
(&#39;int&#39;, [&#39;bool&#39;]) : 11 | [&#39;holiday&#39;, &#39;workingday&#39;, &#39;year&#39;, &#39;season_1&#39;, &#39;season_2&#39;, ...]
Plot summary of models saved to file: AutogluonModels/ag-20230101_065005/SummaryOfModels.html
*** End of fit() summary ***
</code></pre>
</div>
<div class="output execute_result" data-execution_count="60">
<pre><code>{&#39;model_types&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: &#39;StackerEnsembleModel_KNN&#39;,
  &#39;KNeighborsDist_BAG_L1&#39;: &#39;StackerEnsembleModel_KNN&#39;,
  &#39;LightGBMXT_BAG_L1&#39;: &#39;StackerEnsembleModel_LGB&#39;,
  &#39;LightGBM_BAG_L1&#39;: &#39;StackerEnsembleModel_LGB&#39;,
  &#39;RandomForestMSE_BAG_L1&#39;: &#39;StackerEnsembleModel_RF&#39;,
  &#39;CatBoost_BAG_L1&#39;: &#39;StackerEnsembleModel_CatBoost&#39;,
  &#39;ExtraTreesMSE_BAG_L1&#39;: &#39;StackerEnsembleModel_XT&#39;,
  &#39;NeuralNetFastAI_BAG_L1&#39;: &#39;StackerEnsembleModel_NNFastAiTabular&#39;,
  &#39;WeightedEnsemble_L2&#39;: &#39;WeightedEnsembleModel&#39;,
  &#39;LightGBMXT_BAG_L2&#39;: &#39;StackerEnsembleModel_LGB&#39;,
  &#39;LightGBM_BAG_L2&#39;: &#39;StackerEnsembleModel_LGB&#39;,
  &#39;RandomForestMSE_BAG_L2&#39;: &#39;StackerEnsembleModel_RF&#39;,
  &#39;CatBoost_BAG_L2&#39;: &#39;StackerEnsembleModel_CatBoost&#39;,
  &#39;ExtraTreesMSE_BAG_L2&#39;: &#39;StackerEnsembleModel_XT&#39;,
  &#39;NeuralNetFastAI_BAG_L2&#39;: &#39;StackerEnsembleModel_NNFastAiTabular&#39;,
  &#39;WeightedEnsemble_L3&#39;: &#39;WeightedEnsembleModel&#39;},
 &#39;model_performance&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: -89.96695566372658,
  &#39;KNeighborsDist_BAG_L1&#39;: -88.23416597632651,
  &#39;LightGBMXT_BAG_L1&#39;: -37.44651256160773,
  &#39;LightGBM_BAG_L1&#39;: -37.87422721471635,
  &#39;RandomForestMSE_BAG_L1&#39;: -42.24903009152738,
  &#39;CatBoost_BAG_L1&#39;: -37.41835811171351,
  &#39;ExtraTreesMSE_BAG_L1&#39;: -41.56807253024274,
  &#39;NeuralNetFastAI_BAG_L1&#39;: -106.66246057341142,
  &#39;WeightedEnsemble_L2&#39;: -35.93327510589042,
  &#39;LightGBMXT_BAG_L2&#39;: -36.80705411705743,
  &#39;LightGBM_BAG_L2&#39;: -36.290443252039616,
  &#39;RandomForestMSE_BAG_L2&#39;: -36.49589862771968,
  &#39;CatBoost_BAG_L2&#39;: -35.934630222150695,
  &#39;ExtraTreesMSE_BAG_L2&#39;: -36.144358052526194,
  &#39;NeuralNetFastAI_BAG_L2&#39;: -36.72048031197828,
  &#39;WeightedEnsemble_L3&#39;: -35.67964713470299},
 &#39;model_best&#39;: &#39;WeightedEnsemble_L3&#39;,
 &#39;model_paths&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_065005/models/KNeighborsUnif_BAG_L1/&#39;,
  &#39;KNeighborsDist_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_065005/models/KNeighborsDist_BAG_L1/&#39;,
  &#39;LightGBMXT_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_065005/models/LightGBMXT_BAG_L1/&#39;,
  &#39;LightGBM_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_065005/models/LightGBM_BAG_L1/&#39;,
  &#39;RandomForestMSE_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_065005/models/RandomForestMSE_BAG_L1/&#39;,
  &#39;CatBoost_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_065005/models/CatBoost_BAG_L1/&#39;,
  &#39;ExtraTreesMSE_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_065005/models/ExtraTreesMSE_BAG_L1/&#39;,
  &#39;NeuralNetFastAI_BAG_L1&#39;: &#39;AutogluonModels/ag-20230101_065005/models/NeuralNetFastAI_BAG_L1/&#39;,
  &#39;WeightedEnsemble_L2&#39;: &#39;AutogluonModels/ag-20230101_065005/models/WeightedEnsemble_L2/&#39;,
  &#39;LightGBMXT_BAG_L2&#39;: &#39;AutogluonModels/ag-20230101_065005/models/LightGBMXT_BAG_L2/&#39;,
  &#39;LightGBM_BAG_L2&#39;: &#39;AutogluonModels/ag-20230101_065005/models/LightGBM_BAG_L2/&#39;,
  &#39;RandomForestMSE_BAG_L2&#39;: &#39;AutogluonModels/ag-20230101_065005/models/RandomForestMSE_BAG_L2/&#39;,
  &#39;CatBoost_BAG_L2&#39;: &#39;AutogluonModels/ag-20230101_065005/models/CatBoost_BAG_L2/&#39;,
  &#39;ExtraTreesMSE_BAG_L2&#39;: &#39;AutogluonModels/ag-20230101_065005/models/ExtraTreesMSE_BAG_L2/&#39;,
  &#39;NeuralNetFastAI_BAG_L2&#39;: &#39;AutogluonModels/ag-20230101_065005/models/NeuralNetFastAI_BAG_L2/&#39;,
  &#39;WeightedEnsemble_L3&#39;: &#39;AutogluonModels/ag-20230101_065005/models/WeightedEnsemble_L3/&#39;},
 &#39;model_fit_times&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: 0.03653573989868164,
  &#39;KNeighborsDist_BAG_L1&#39;: 0.030507802963256836,
  &#39;LightGBMXT_BAG_L1&#39;: 85.24406099319458,
  &#39;LightGBM_BAG_L1&#39;: 42.201159954071045,
  &#39;RandomForestMSE_BAG_L1&#39;: 10.076409101486206,
  &#39;CatBoost_BAG_L1&#39;: 216.002512216568,
  &#39;ExtraTreesMSE_BAG_L1&#39;: 9.48087453842163,
  &#39;NeuralNetFastAI_BAG_L1&#39;: 42.999202728271484,
  &#39;WeightedEnsemble_L2&#39;: 0.37021923065185547,
  &#39;LightGBMXT_BAG_L2&#39;: 21.09792137145996,
  &#39;LightGBM_BAG_L2&#39;: 24.723501682281494,
  &#39;RandomForestMSE_BAG_L2&#39;: 27.59481167793274,
  &#39;CatBoost_BAG_L2&#39;: 33.117414712905884,
  &#39;ExtraTreesMSE_BAG_L2&#39;: 12.167774438858032,
  &#39;NeuralNetFastAI_BAG_L2&#39;: 51.308558225631714,
  &#39;WeightedEnsemble_L3&#39;: 0.37259960174560547},
 &#39;model_pred_times&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: 0.07668280601501465,
  &#39;KNeighborsDist_BAG_L1&#39;: 0.08696198463439941,
  &#39;LightGBMXT_BAG_L1&#39;: 24.563970804214478,
  &#39;LightGBM_BAG_L1&#39;: 3.523054838180542,
  &#39;RandomForestMSE_BAG_L1&#39;: 0.5481634140014648,
  &#39;CatBoost_BAG_L1&#39;: 0.19000744819641113,
  &#39;ExtraTreesMSE_BAG_L1&#39;: 0.7684659957885742,
  &#39;NeuralNetFastAI_BAG_L1&#39;: 0.43160390853881836,
  &#39;WeightedEnsemble_L2&#39;: 0.0009648799896240234,
  &#39;LightGBMXT_BAG_L2&#39;: 0.20467138290405273,
  &#39;LightGBM_BAG_L2&#39;: 0.1023714542388916,
  &#39;RandomForestMSE_BAG_L2&#39;: 0.6638827323913574,
  &#39;CatBoost_BAG_L2&#39;: 0.05765414237976074,
  &#39;ExtraTreesMSE_BAG_L2&#39;: 0.6523752212524414,
  &#39;NeuralNetFastAI_BAG_L2&#39;: 0.5020430088043213,
  &#39;WeightedEnsemble_L3&#39;: 0.0012693405151367188},
 &#39;num_bag_folds&#39;: 8,
 &#39;max_stack_level&#39;: 3,
 &#39;model_hyperparams&#39;: {&#39;KNeighborsUnif_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;KNeighborsDist_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;LightGBMXT_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;LightGBM_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;RandomForestMSE_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;CatBoost_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;ExtraTreesMSE_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;NeuralNetFastAI_BAG_L1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;WeightedEnsemble_L2&#39;: {&#39;use_orig_features&#39;: False,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;LightGBMXT_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;LightGBM_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;RandomForestMSE_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;CatBoost_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;ExtraTreesMSE_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True,
   &#39;use_child_oof&#39;: True},
  &#39;NeuralNetFastAI_BAG_L2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;WeightedEnsemble_L3&#39;: {&#39;use_orig_features&#39;: False,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True}},
 &#39;leaderboard&#39;:                      model   score_val  pred_time_val    fit_time  \
 0      WeightedEnsemble_L3  -35.679647      32.168507  555.355923   
 1      WeightedEnsemble_L2  -35.933275      29.681589  363.405744   
 2          CatBoost_BAG_L2  -35.934630      30.246565  439.188678   
 3     ExtraTreesMSE_BAG_L2  -36.144358      30.841286  418.239038   
 4          LightGBM_BAG_L2  -36.290443      30.291283  430.794765   
 5   RandomForestMSE_BAG_L2  -36.495899      30.852794  433.666075   
 6   NeuralNetFastAI_BAG_L2  -36.720480      30.690954  457.379821   
 7        LightGBMXT_BAG_L2  -36.807054      30.393583  427.169184   
 8          CatBoost_BAG_L1  -37.418358       0.190007  216.002512   
 9        LightGBMXT_BAG_L1  -37.446513      24.563971   85.244061   
 10         LightGBM_BAG_L1  -37.874227       3.523055   42.201160   
 11    ExtraTreesMSE_BAG_L1  -41.568073       0.768466    9.480875   
 12  RandomForestMSE_BAG_L1  -42.249030       0.548163   10.076409   
 13   KNeighborsDist_BAG_L1  -88.234166       0.086962    0.030508   
 14   KNeighborsUnif_BAG_L1  -89.966956       0.076683    0.036536   
 15  NeuralNetFastAI_BAG_L1 -106.662461       0.431604   42.999203   
 
     pred_time_val_marginal  fit_time_marginal  stack_level  can_infer  \
 0                 0.001269           0.372600            3       True   
 1                 0.000965           0.370219            2       True   
 2                 0.057654          33.117415            2       True   
 3                 0.652375          12.167774            2       True   
 4                 0.102371          24.723502            2       True   
 5                 0.663883          27.594812            2       True   
 6                 0.502043          51.308558            2       True   
 7                 0.204671          21.097921            2       True   
 8                 0.190007         216.002512            1       True   
 9                24.563971          85.244061            1       True   
 10                3.523055          42.201160            1       True   
 11                0.768466           9.480875            1       True   
 12                0.548163          10.076409            1       True   
 13                0.086962           0.030508            1       True   
 14                0.076683           0.036536            1       True   
 15                0.431604          42.999203            1       True   
 
     fit_order  
 0          16  
 1           9  
 2          13  
 3          14  
 4          11  
 5          12  
 6          15  
 7          10  
 8           6  
 9           3  
 10          4  
 11          7  
 12          5  
 13          2  
 14          1  
 15          8  }</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="61"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:426}"
id="r50ixcpOJoGB" data-outputId="ebc06812-eaf6-4196-b838-b080f6950f50">
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>predictor_new_features.leaderboard(silent<span class="op">=</span><span class="va">True</span>).plot(kind<span class="op">=</span><span class="st">&quot;bar&quot;</span>, x<span class="op">=</span><span class="st">&quot;model&quot;</span>, y<span class="op">=</span><span class="st">&quot;score_val&quot;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="61">
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f17d695ef10&gt;</code></pre>
</div>
<div class="output display_data">
<p><img
src="./img/leaderboard_02.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="62" id="8QvRvQPSIvg2">
<div class="sourceCode" id="cb45"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remember to set all negative values to zero</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>predictions_new_features <span class="op">=</span> predictor_new_features.predict(test)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>predictions_new_features[predictions_new_features <span class="op">&lt;</span> <span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="63" id="7ML4a0mtIxA1">
<div class="sourceCode" id="cb46"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Same submitting predictions</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>submission_new_features <span class="op">=</span> submission</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>submission_new_features[<span class="st">&quot;count&quot;</span>] <span class="op">=</span> predictions_new_features</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>submission_new_features.to_csv(<span class="st">&quot;submission_new_features.csv&quot;</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="64"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="JR-pY4GYIyrH" data-outputId="6aaffa7d-0fcd-4d96-a1bb-2a0080fddae2">
<div class="sourceCode" id="cb47"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>kaggle competitions submit <span class="op">-</span>c bike<span class="op">-</span>sharing<span class="op">-</span>demand <span class="op">-</span>f submission_new_features.csv <span class="op">-</span>m <span class="st">&quot;new features&quot;</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>100% 188k/188k [00:00&lt;00:00, 210kB/s]
Successfully submitted to Bike Sharing Demand</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="65"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="tNaIkzXBI0aO" data-outputId="e0c70c23-fc44-438e-b0d1-23e8adc103f2">
<div class="sourceCode" id="cb49"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>kaggle competitions submissions <span class="op">-</span>c bike<span class="op">-</span>sharing<span class="op">-</span>demand <span class="op">|</span> tail <span class="op">-</span>n <span class="op">+</span><span class="dv">1</span> <span class="op">|</span> head <span class="op">-</span>n <span class="dv">6</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>fileName                     date                 description                        status    publicScore  privateScore  
---------------------------  -------------------  ---------------------------------  --------  -----------  ------------  
submission_new_features.csv  2023-01-01 07:02:27  new features                       complete  0.46995      0.46995       
submission.csv               2023-01-01 06:47:24  first raw submission               complete  1.80654      1.80654       
submission.csv               2023-01-01 06:21:25  first raw submission               complete  0.46659      0.46659       
submission_new_hpo.csv       2022-12-31 19:29:29  new features with hyperparameters  complete  0.52633      0.52633       
</code></pre>
</div>
</div>
<section id="new-score-of-046995" class="cell markdown"
id="zj3YwjAyI4LG">
<h4>New Score of 0.46995</h4>
</section>
<section id="step-6-hyper-parameter-optimization" class="cell markdown"
id="dqTsj1inI7VW">
<h2>Step 6: Hyper parameter optimization</h2>
<ul>
<li>There are many options for hyper parameter optimization.</li>
<li>Options are to change the AutoGluon higher level parameters or the
individual model hyperparameters.</li>
<li>The hyperparameters of the models themselves that are in AutoGluon.
Those need the <code>hyperparameter</code> and
<code>hyperparameter_tune_kwargs</code> arguments.</li>
</ul>
</section>
<div class="cell code" data-execution_count="66" id="5qBAVvlaJwIU">
<div class="sourceCode" id="cb51"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> autogluon.core <span class="im">as</span> ag</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>nn_options <span class="op">=</span> {</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;num_epochs&#39;</span>: <span class="dv">10</span>,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;learning_rate&#39;</span>: ag.space.Real(<span class="fl">1e-4</span>, <span class="fl">1e-2</span>, default<span class="op">=</span><span class="fl">5e-4</span>, log<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;activation&#39;</span>: ag.space.Categorical(<span class="st">&#39;relu&#39;</span>, <span class="st">&#39;softrelu&#39;</span>, <span class="st">&#39;tanh&#39;</span>),</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;dropout_prob&#39;</span>: ag.space.Real(<span class="fl">0.0</span>, <span class="fl">0.5</span>, default<span class="op">=</span><span class="fl">0.1</span>),</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>gbm1_options <span class="op">=</span> {</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">100</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>gbm2_options <span class="op">=</span> {</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">200</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>hyperparameters <span class="op">=</span> {</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;NN&#39;</span>: nn_options,</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;GBM&#39;</span>: gbm1_options,</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;GBM&#39;</span>: gbm2_options</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a><span class="co"># try at most 3 different hyperparameter configurations for each type of model</span></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>num_trials <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a><span class="co"># to tune hyperparameters using random search routine with a local scheduler</span></span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>search_strategy <span class="op">=</span> <span class="st">&#39;auto&#39;</span></span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>hyperparameter_tune_kwargs <span class="op">=</span> {</span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;num_trials&#39;</span>: num_trials,</span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;scheduler&#39;</span> : <span class="st">&#39;local&#39;</span>,</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;searcher&#39;</span>: search_strategy,</span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="67"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000,&quot;referenced_widgets&quot;:[&quot;af72d4c5b1f549678ea516b970555609&quot;,&quot;ea591bb4b98349d1ae25bedfbbdc5396&quot;,&quot;bf21c11fc7d44bed89cdd819459ac8d5&quot;,&quot;9b7b1506dd264fbe95a5bdd748d9cd54&quot;,&quot;c652a0784a6b49d19e53ef2ae08c8e98&quot;,&quot;cf5dd121aa804df2af9c5e7d78e4862a&quot;,&quot;aefd18f3e6e24efe869219e90a2ea839&quot;,&quot;a9bc421b23f846aea8fc9d5bbbc52251&quot;,&quot;2952c148d62043929a015dd24b6cbb79&quot;,&quot;f1c02b2c5009412e85c4932fa9cb63f6&quot;,&quot;7b83a1e6620b4d898b43ce9342448eef&quot;,&quot;14c58e680a694e98a1c4eec8945db478&quot;,&quot;9ad5d45b2fdd4cc79dbd86efe6d181e1&quot;,&quot;41e71e2f4d25441d98c0a21f5b7565f3&quot;,&quot;bca0255171db41f089d75dd9ab1ab1b6&quot;,&quot;729092407fc648ca96099fba8dede065&quot;,&quot;b6c03e1c266f413fa703bb442b7cc66a&quot;,&quot;14e04b3b877244dc9d3d5d89fcb9d5c0&quot;,&quot;d6fb766ca58c41389953048b3f778561&quot;,&quot;c603d98d717145759829fd800774c51c&quot;,&quot;ec4bb89e315543309ff25e8438d0e2a3&quot;,&quot;9ca9b92d9cbd4d93bf4d4ec627d1dae3&quot;,&quot;fcc25fcaff6e4aa69c6703798baa288d&quot;,&quot;f2b5442f64ff4d64b1febafd1685e754&quot;,&quot;c179107a097c4cd3a76a8919af64ae64&quot;,&quot;9897c9ed1ffc4bedbbb2a6634a218320&quot;,&quot;373a8f3db33149d29f9f6d0c98541a6c&quot;,&quot;6cf03b59ccf74bb19188a7747896ad11&quot;,&quot;74241e43f2634d10ae9dd1107f3f1035&quot;,&quot;46a8e80688e34d65adda542c1fd55fd4&quot;,&quot;d4a6ae91b480414e81c8f5199faf03da&quot;,&quot;dfd0af2b25f9478e96a3e0ea11758f85&quot;,&quot;995f764c67ac4e3396fab4e929d15ee1&quot;,&quot;e931a9a34b474b0a9e778f1b88621314&quot;,&quot;83821ec16377444fa0d8323bb541686f&quot;,&quot;b580849a6a3c4200bf354ba7690375f1&quot;,&quot;75635a8658ae4183bdca581adc4cdcb9&quot;,&quot;33ff57b06de64d1593df1ae0326d8a1c&quot;,&quot;797db4f9891f4450b0a3a356ce3cf65c&quot;,&quot;3f20287851e743c8b79d8a141769e695&quot;,&quot;411b85bc7a6c4e3eae22f791e6681b6e&quot;,&quot;64bb8aed2a3248678a9bfce762e5952e&quot;,&quot;7011b5fe55484a96b64d08811ff5379d&quot;,&quot;321bf1f5ba5f42e588216d241b82dac4&quot;]}"
id="_gxzpKJNI2P1" data-outputId="c0945ddf-dfea-4455-99db-f20fd752c867">
<div class="sourceCode" id="cb52"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>predictor_new_hpo <span class="op">=</span> TabularPredictor(</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>    label <span class="op">=</span> <span class="st">&quot;count&quot;</span>,</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    problem_type <span class="op">=</span> <span class="st">&quot;regression&quot;</span>,</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    eval_metric <span class="op">=</span> <span class="st">&quot;root_mean_squared_error&quot;</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  ).fit(</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>      train_data <span class="op">=</span> train,</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>      time_limit <span class="op">=</span> <span class="dv">600</span>,</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>      presets <span class="op">=</span> <span class="st">&quot;best_quality&quot;</span>,</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>      num_bag_sets<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>      hyperparameters <span class="op">=</span> hyperparameters, </span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>      hyperparameter_tune_kwargs <span class="op">=</span> hyperparameter_tune_kwargs,</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<div class="output stream stderr">
<pre><code>No path specified. Models will be saved in: &quot;AutogluonModels/ag-20230101_070333/&quot;
Presets specified: [&#39;best_quality&#39;]
Warning: hyperparameter tuning is currently experimental and may cause the process to hang.
Stack configuration (auto_stack=True): num_stack_levels=1, num_bag_folds=8, num_bag_sets=1
Beginning AutoGluon training ... Time limit = 600s
AutoGluon will save models to &quot;AutogluonModels/ag-20230101_070333/&quot;
AutoGluon Version:  0.6.1
Python Version:     3.8.16
Operating System:   Linux
Platform Machine:   x86_64
Platform Version:   #1 SMP Fri Aug 26 08:44:51 UTC 2022
Train Data Rows:    10886
Train Data Columns: 20
Label Column: count
Preprocessing data ...
Using Feature Generators to preprocess the data ...
Fitting AutoMLPipelineFeatureGenerator...
	Available Memory:                    10919.2 MB
	Train Data (Original)  Memory Usage: 1.13 MB (0.0% of available memory)
	Inferring data type of each feature based on column values. Set feature_metadata_in to manually specify special dtypes of the features.
	Stage 1 Generators:
		Fitting AsTypeFeatureGenerator...
			Note: Converting 11 features to boolean dtype as they only contain 2 unique values.
	Stage 2 Generators:
		Fitting FillNaFeatureGenerator...
	Stage 3 Generators:
		Fitting IdentityFeatureGenerator...
	Stage 4 Generators:
		Fitting DropUniqueFeatureGenerator...
	Useless Original Features (Count: 2): [&#39;minute&#39;, &#39;second&#39;]
		These features carry no predictive signal and should be manually investigated.
		This is typically a feature which has the same value for all rows.
		These features do not need to be present at inference time.
	Types of features in original data (raw dtype, special dtypes):
		(&#39;float&#39;, []) :  4 | [&#39;temp&#39;, &#39;atemp&#39;, &#39;humidity&#39;, &#39;windspeed&#39;]
		(&#39;int&#39;, [])   : 14 | [&#39;holiday&#39;, &#39;workingday&#39;, &#39;year&#39;, &#39;month&#39;, &#39;day&#39;, ...]
	Types of features in processed data (raw dtype, special dtypes):
		(&#39;float&#39;, [])     :  4 | [&#39;temp&#39;, &#39;atemp&#39;, &#39;humidity&#39;, &#39;windspeed&#39;]
		(&#39;int&#39;, [])       :  3 | [&#39;month&#39;, &#39;day&#39;, &#39;hour&#39;]
		(&#39;int&#39;, [&#39;bool&#39;]) : 11 | [&#39;holiday&#39;, &#39;workingday&#39;, &#39;year&#39;, &#39;season_1&#39;, &#39;season_2&#39;, ...]
	0.2s = Fit runtime
	18 features in original data used to generate 18 features in processed data.
	Train Data (Processed) Memory Usage: 0.73 MB (0.0% of available memory)
Data preprocessing and feature engineering runtime = 0.25s ...
AutoGluon will gauge predictive performance using evaluation metric: &#39;root_mean_squared_error&#39;
	This metric&#39;s sign has been flipped to adhere to being higher_is_better. The metric score can be multiplied by -1 to get the metric value.
	To change this, specify the eval_metric parameter of Predictor()
AutoGluon will fit 2 stack levels (L1 to L2) ...
	WARNING: &quot;NN&quot; model has been deprecated in v0.4.0 and renamed to &quot;NN_MXNET&quot;. Starting in v0.6.0, specifying &quot;NN&quot; or &quot;NN_MXNET&quot; will raise an exception. Consider instead specifying &quot;NN_TORCH&quot;.
Fitting 2 L1 models ...
Hyperparameter tuning model: LightGBM_BAG_L1 ... Tuning model for up to 179.88s of the 599.74s of remaining time.
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb54"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;af72d4c5b1f549678ea516b970555609&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stderr">
<pre><code>	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
Fitted model: LightGBM_BAG_L1/T1 ...
	-41.2565	 = Validation score   (-root_mean_squared_error)
	24.63s	 = Training   runtime
	0.0s	 = Validation runtime
Fitted model: LightGBM_BAG_L1/T2 ...
	-38.2204	 = Validation score   (-root_mean_squared_error)
	23.37s	 = Training   runtime
	0.0s	 = Validation runtime
Fitted model: LightGBM_BAG_L1/T3 ...
	-40.6632	 = Validation score   (-root_mean_squared_error)
	22.57s	 = Training   runtime
	0.0s	 = Validation runtime
Hyperparameter tuning model: NeuralNetMXNet_BAG_L1 ... Tuning model for up to 179.88s of the 528.97s of remaining time.
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb56"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;14c58e680a694e98a1c4eec8945db478&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stderr">
<pre><code>	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	Stopping HPO to satisfy time limit...
Fitted model: NeuralNetMXNet_BAG_L1/T1 ...
	-94.7667	 = Validation score   (-root_mean_squared_error)
	83.79s	 = Training   runtime
	0.0s	 = Validation runtime
Fitted model: NeuralNetMXNet_BAG_L1/T2 ...
	-105.3215	 = Validation score   (-root_mean_squared_error)
	79.45s	 = Training   runtime
	0.0s	 = Validation runtime
Fitting model: WeightedEnsemble_L2 ... Training model for up to 360.0s of the 365.58s of remaining time.
	-38.163	 = Validation score   (-root_mean_squared_error)
	0.26s	 = Training   runtime
	0.0s	 = Validation runtime
	WARNING: &quot;NN&quot; model has been deprecated in v0.4.0 and renamed to &quot;NN_MXNET&quot;. Starting in v0.6.0, specifying &quot;NN&quot; or &quot;NN_MXNET&quot; will raise an exception. Consider instead specifying &quot;NN_TORCH&quot;.
Fitting 2 L2 models ...
Hyperparameter tuning model: LightGBM_BAG_L2 ... Tuning model for up to 164.38s of the 365.28s of remaining time.
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb58"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;fcc25fcaff6e4aa69c6703798baa288d&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stderr">
<pre><code>	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
Fitted model: LightGBM_BAG_L2/T1 ...
	-39.0186	 = Validation score   (-root_mean_squared_error)
	26.18s	 = Training   runtime
	0.0s	 = Validation runtime
Fitted model: LightGBM_BAG_L2/T2 ...
	-39.708	 = Validation score   (-root_mean_squared_error)
	26.14s	 = Training   runtime
	0.0s	 = Validation runtime
Fitted model: LightGBM_BAG_L2/T3 ...
	-39.0546	 = Validation score   (-root_mean_squared_error)
	22.9s	 = Training   runtime
	0.0s	 = Validation runtime
Hyperparameter tuning model: NeuralNetMXNet_BAG_L2 ... Tuning model for up to 164.38s of the 289.93s of remaining time.
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb60"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;e931a9a34b474b0a9e778f1b88621314&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stderr">
<pre><code>	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy
	Stopping HPO to satisfy time limit...
Fitted model: NeuralNetMXNet_BAG_L2/T1 ...
	-39.9869	 = Validation score   (-root_mean_squared_error)
	81.69s	 = Training   runtime
	0.0s	 = Validation runtime
Fitted model: NeuralNetMXNet_BAG_L2/T2 ...
	-59.2306	 = Validation score   (-root_mean_squared_error)
	68.46s	 = Training   runtime
	0.0s	 = Validation runtime
Fitting model: WeightedEnsemble_L3 ... Training model for up to 360.0s of the 139.63s of remaining time.
	-38.6342	 = Validation score   (-root_mean_squared_error)
	0.3s	 = Training   runtime
	0.0s	 = Validation runtime
AutoGluon training complete, total runtime = 460.75s ... Best model: &quot;WeightedEnsemble_L2&quot;
TabularPredictor saved. To load, use: predictor = TabularPredictor.load(&quot;AutogluonModels/ag-20230101_070333/&quot;)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="68"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="Heq-JxFBI9aQ" data-outputId="b123d829-13f2-429a-b689-e8b2831703cc">
<div class="sourceCode" id="cb62"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>predictor_new_hpo.fit_summary()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>*** Summary of fit() ***
Estimated performance of each model:
                       model   score_val  pred_time_val    fit_time  pred_time_val_marginal  fit_time_marginal  stack_level  can_infer  fit_order
0        WeightedEnsemble_L2  -38.163024       0.001030   70.834871                0.000674           0.264607            2       True          6
1         LightGBM_BAG_L1/T2  -38.220388       0.000129   23.366467                0.000129          23.366467            1       True          2
2        WeightedEnsemble_L3  -38.634211       0.002237  459.486344                0.000979           0.303727            3       True         12
3         LightGBM_BAG_L2/T1  -39.018584       0.000767  259.989165                0.000114          26.177173            2       True          7
4         LightGBM_BAG_L2/T3  -39.054631       0.000775  256.708821                0.000122          22.896830            2       True          9
5         LightGBM_BAG_L2/T2  -39.707969       0.000804  259.953368                0.000151          26.141376            2       True          8
6   NeuralNetMXNet_BAG_L2/T1  -39.986908       0.000770  315.504984                0.000117          81.692993            2       True         10
7         LightGBM_BAG_L1/T3  -40.663209       0.000110   22.570709                0.000110          22.570709            1       True          3
8         LightGBM_BAG_L1/T1  -41.256491       0.000117   24.633087                0.000117          24.633087            1       True          1
9   NeuralNetMXNet_BAG_L2/T2  -59.230597       0.000755  302.274245                0.000102          68.462253            2       True         11
10  NeuralNetMXNet_BAG_L1/T1  -94.766664       0.000127   83.790164                0.000127          83.790164            1       True          4
11  NeuralNetMXNet_BAG_L1/T2 -105.321520       0.000170   79.451564                0.000170          79.451564            1       True          5
Number of models trained: 12
Types of models trained:
{&#39;WeightedEnsembleModel&#39;, &#39;StackerEnsembleModel_LGB&#39;, &#39;StackerEnsembleModel_TabularNeuralNetMxnet&#39;}
Bagging used: True  (with 8 folds)
Multi-layer stack-ensembling used: True  (with 3 levels)
Feature Metadata (Processed):
(raw dtype, special dtypes):
(&#39;float&#39;, [])     :  4 | [&#39;temp&#39;, &#39;atemp&#39;, &#39;humidity&#39;, &#39;windspeed&#39;]
(&#39;int&#39;, [])       :  3 | [&#39;month&#39;, &#39;day&#39;, &#39;hour&#39;]
(&#39;int&#39;, [&#39;bool&#39;]) : 11 | [&#39;holiday&#39;, &#39;workingday&#39;, &#39;year&#39;, &#39;season_1&#39;, &#39;season_2&#39;, ...]
Plot summary of models saved to file: AutogluonModels/ag-20230101_070333/SummaryOfModels.html
*** End of fit() summary ***
</code></pre>
</div>
<div class="output execute_result" data-execution_count="68">
<pre><code>{&#39;model_types&#39;: {&#39;LightGBM_BAG_L1/T1&#39;: &#39;StackerEnsembleModel_LGB&#39;,
  &#39;LightGBM_BAG_L1/T2&#39;: &#39;StackerEnsembleModel_LGB&#39;,
  &#39;LightGBM_BAG_L1/T3&#39;: &#39;StackerEnsembleModel_LGB&#39;,
  &#39;NeuralNetMXNet_BAG_L1/T1&#39;: &#39;StackerEnsembleModel_TabularNeuralNetMxnet&#39;,
  &#39;NeuralNetMXNet_BAG_L1/T2&#39;: &#39;StackerEnsembleModel_TabularNeuralNetMxnet&#39;,
  &#39;WeightedEnsemble_L2&#39;: &#39;WeightedEnsembleModel&#39;,
  &#39;LightGBM_BAG_L2/T1&#39;: &#39;StackerEnsembleModel_LGB&#39;,
  &#39;LightGBM_BAG_L2/T2&#39;: &#39;StackerEnsembleModel_LGB&#39;,
  &#39;LightGBM_BAG_L2/T3&#39;: &#39;StackerEnsembleModel_LGB&#39;,
  &#39;NeuralNetMXNet_BAG_L2/T1&#39;: &#39;StackerEnsembleModel_TabularNeuralNetMxnet&#39;,
  &#39;NeuralNetMXNet_BAG_L2/T2&#39;: &#39;StackerEnsembleModel_TabularNeuralNetMxnet&#39;,
  &#39;WeightedEnsemble_L3&#39;: &#39;WeightedEnsembleModel&#39;},
 &#39;model_performance&#39;: {&#39;LightGBM_BAG_L1/T1&#39;: -41.25649060789932,
  &#39;LightGBM_BAG_L1/T2&#39;: -38.22038755891459,
  &#39;LightGBM_BAG_L1/T3&#39;: -40.663208972131784,
  &#39;NeuralNetMXNet_BAG_L1/T1&#39;: -94.7666637256548,
  &#39;NeuralNetMXNet_BAG_L1/T2&#39;: -105.3215195209248,
  &#39;WeightedEnsemble_L2&#39;: -38.16302399425689,
  &#39;LightGBM_BAG_L2/T1&#39;: -39.01858415806448,
  &#39;LightGBM_BAG_L2/T2&#39;: -39.70796924460562,
  &#39;LightGBM_BAG_L2/T3&#39;: -39.054631335965155,
  &#39;NeuralNetMXNet_BAG_L2/T1&#39;: -39.98690806027704,
  &#39;NeuralNetMXNet_BAG_L2/T2&#39;: -59.230597031167605,
  &#39;WeightedEnsemble_L3&#39;: -38.63421095782559},
 &#39;model_best&#39;: &#39;WeightedEnsemble_L2&#39;,
 &#39;model_paths&#39;: {&#39;LightGBM_BAG_L1/T1&#39;: &#39;/content/AutogluonModels/ag-20230101_070333/models/LightGBM_BAG_L1/T1/&#39;,
  &#39;LightGBM_BAG_L1/T2&#39;: &#39;/content/AutogluonModels/ag-20230101_070333/models/LightGBM_BAG_L1/T2/&#39;,
  &#39;LightGBM_BAG_L1/T3&#39;: &#39;/content/AutogluonModels/ag-20230101_070333/models/LightGBM_BAG_L1/T3/&#39;,
  &#39;NeuralNetMXNet_BAG_L1/T1&#39;: &#39;/content/AutogluonModels/ag-20230101_070333/models/NeuralNetMXNet_BAG_L1/T1/&#39;,
  &#39;NeuralNetMXNet_BAG_L1/T2&#39;: &#39;/content/AutogluonModels/ag-20230101_070333/models/NeuralNetMXNet_BAG_L1/T2/&#39;,
  &#39;WeightedEnsemble_L2&#39;: &#39;AutogluonModels/ag-20230101_070333/models/WeightedEnsemble_L2/&#39;,
  &#39;LightGBM_BAG_L2/T1&#39;: &#39;/content/AutogluonModels/ag-20230101_070333/models/LightGBM_BAG_L2/T1/&#39;,
  &#39;LightGBM_BAG_L2/T2&#39;: &#39;/content/AutogluonModels/ag-20230101_070333/models/LightGBM_BAG_L2/T2/&#39;,
  &#39;LightGBM_BAG_L2/T3&#39;: &#39;/content/AutogluonModels/ag-20230101_070333/models/LightGBM_BAG_L2/T3/&#39;,
  &#39;NeuralNetMXNet_BAG_L2/T1&#39;: &#39;/content/AutogluonModels/ag-20230101_070333/models/NeuralNetMXNet_BAG_L2/T1/&#39;,
  &#39;NeuralNetMXNet_BAG_L2/T2&#39;: &#39;/content/AutogluonModels/ag-20230101_070333/models/NeuralNetMXNet_BAG_L2/T2/&#39;,
  &#39;WeightedEnsemble_L3&#39;: &#39;AutogluonModels/ag-20230101_070333/models/WeightedEnsemble_L3/&#39;},
 &#39;model_fit_times&#39;: {&#39;LightGBM_BAG_L1/T1&#39;: 24.633087396621704,
  &#39;LightGBM_BAG_L1/T2&#39;: 23.366467237472534,
  &#39;LightGBM_BAG_L1/T3&#39;: 22.570708990097046,
  &#39;NeuralNetMXNet_BAG_L1/T1&#39;: 83.79016351699829,
  &#39;NeuralNetMXNet_BAG_L1/T2&#39;: 79.4515643119812,
  &#39;WeightedEnsemble_L2&#39;: 0.26460695266723633,
  &#39;LightGBM_BAG_L2/T1&#39;: 26.177173137664795,
  &#39;LightGBM_BAG_L2/T2&#39;: 26.141376495361328,
  &#39;LightGBM_BAG_L2/T3&#39;: 22.896829843521118,
  &#39;NeuralNetMXNet_BAG_L2/T1&#39;: 81.69299292564392,
  &#39;NeuralNetMXNet_BAG_L2/T2&#39;: 68.46225309371948,
  &#39;WeightedEnsemble_L3&#39;: 0.303727388381958},
 &#39;model_pred_times&#39;: {&#39;LightGBM_BAG_L1/T1&#39;: 0.00011730194091796875,
  &#39;LightGBM_BAG_L1/T2&#39;: 0.00012874603271484375,
  &#39;LightGBM_BAG_L1/T3&#39;: 0.00011014938354492188,
  &#39;NeuralNetMXNet_BAG_L1/T1&#39;: 0.00012731552124023438,
  &#39;NeuralNetMXNet_BAG_L1/T2&#39;: 0.00016951560974121094,
  &#39;WeightedEnsemble_L2&#39;: 0.0006735324859619141,
  &#39;LightGBM_BAG_L2/T1&#39;: 0.00011372566223144531,
  &#39;LightGBM_BAG_L2/T2&#39;: 0.00015091896057128906,
  &#39;LightGBM_BAG_L2/T3&#39;: 0.0001220703125,
  &#39;NeuralNetMXNet_BAG_L2/T1&#39;: 0.00011658668518066406,
  &#39;NeuralNetMXNet_BAG_L2/T2&#39;: 0.00010180473327636719,
  &#39;WeightedEnsemble_L3&#39;: 0.0009791851043701172},
 &#39;num_bag_folds&#39;: 8,
 &#39;max_stack_level&#39;: 3,
 &#39;model_hyperparams&#39;: {&#39;LightGBM_BAG_L1/T1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;LightGBM_BAG_L1/T2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;LightGBM_BAG_L1/T3&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;NeuralNetMXNet_BAG_L1/T1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;NeuralNetMXNet_BAG_L1/T2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;WeightedEnsemble_L2&#39;: {&#39;use_orig_features&#39;: False,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;LightGBM_BAG_L2/T1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;LightGBM_BAG_L2/T2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;LightGBM_BAG_L2/T3&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;NeuralNetMXNet_BAG_L2/T1&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;NeuralNetMXNet_BAG_L2/T2&#39;: {&#39;use_orig_features&#39;: True,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True},
  &#39;WeightedEnsemble_L3&#39;: {&#39;use_orig_features&#39;: False,
   &#39;max_base_models&#39;: 25,
   &#39;max_base_models_per_type&#39;: 5,
   &#39;save_bag_folds&#39;: True}},
 &#39;leaderboard&#39;:                        model   score_val  pred_time_val    fit_time  \
 0        WeightedEnsemble_L2  -38.163024       0.001030   70.834871   
 1         LightGBM_BAG_L1/T2  -38.220388       0.000129   23.366467   
 2        WeightedEnsemble_L3  -38.634211       0.002237  459.486344   
 3         LightGBM_BAG_L2/T1  -39.018584       0.000767  259.989165   
 4         LightGBM_BAG_L2/T3  -39.054631       0.000775  256.708821   
 5         LightGBM_BAG_L2/T2  -39.707969       0.000804  259.953368   
 6   NeuralNetMXNet_BAG_L2/T1  -39.986908       0.000770  315.504984   
 7         LightGBM_BAG_L1/T3  -40.663209       0.000110   22.570709   
 8         LightGBM_BAG_L1/T1  -41.256491       0.000117   24.633087   
 9   NeuralNetMXNet_BAG_L2/T2  -59.230597       0.000755  302.274245   
 10  NeuralNetMXNet_BAG_L1/T1  -94.766664       0.000127   83.790164   
 11  NeuralNetMXNet_BAG_L1/T2 -105.321520       0.000170   79.451564   
 
     pred_time_val_marginal  fit_time_marginal  stack_level  can_infer  \
 0                 0.000674           0.264607            2       True   
 1                 0.000129          23.366467            1       True   
 2                 0.000979           0.303727            3       True   
 3                 0.000114          26.177173            2       True   
 4                 0.000122          22.896830            2       True   
 5                 0.000151          26.141376            2       True   
 6                 0.000117          81.692993            2       True   
 7                 0.000110          22.570709            1       True   
 8                 0.000117          24.633087            1       True   
 9                 0.000102          68.462253            2       True   
 10                0.000127          83.790164            1       True   
 11                0.000170          79.451564            1       True   
 
     fit_order  
 0           6  
 1           2  
 2          12  
 3           7  
 4           9  
 5           8  
 6          10  
 7           3  
 8           1  
 9          11  
 10          4  
 11          5  }</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="69" id="EuPyzZ5QI-uP">
<div class="sourceCode" id="cb65"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remember to set all negative values to zero</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>predictions_new_hpo <span class="op">=</span> predictor_new_hpo.predict(test)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>predictions_new_hpo[predictions_new_hpo <span class="op">&lt;</span> <span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="70" id="Ew72F8X1JA_d">
<div class="sourceCode" id="cb66"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Same submitting predictions</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>submission_new_hpo <span class="op">=</span> submission</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>submission_new_hpo[<span class="st">&quot;count&quot;</span>] <span class="op">=</span> predictions_new_hpo</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>submission_new_hpo.to_csv(<span class="st">&quot;submission_new_hpo.csv&quot;</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="71"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="sBPTt-NAJCrq" data-outputId="89b73055-86f9-497d-e8bd-560b67b51779">
<div class="sourceCode" id="cb67"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>kaggle competitions submit <span class="op">-</span>c bike<span class="op">-</span>sharing<span class="op">-</span>demand <span class="op">-</span>f submission_new_hpo.csv <span class="op">-</span>m <span class="st">&quot;new features with hyperparameters&quot;</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>100% 188k/188k [00:00&lt;00:00, 228kB/s]
Successfully submitted to Bike Sharing Demand</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="72"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="0oAS9KtDJEqW" data-outputId="556c0d92-8d4c-4787-f96f-b60e6a24bb12">
<div class="sourceCode" id="cb69"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>kaggle competitions submissions <span class="op">-</span>c bike<span class="op">-</span>sharing<span class="op">-</span>demand <span class="op">|</span> tail <span class="op">-</span>n <span class="op">+</span><span class="dv">1</span> <span class="op">|</span> head <span class="op">-</span>n <span class="dv">6</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>fileName                     date                 description                        status    publicScore  privateScore  
---------------------------  -------------------  ---------------------------------  --------  -----------  ------------  
submission_new_hpo.csv       2023-01-01 07:13:51  new features with hyperparameters  complete  0.52633      0.52633       
submission_new_features.csv  2023-01-01 07:02:27  new features                       complete  0.46995      0.46995       
submission.csv               2023-01-01 06:47:24  first raw submission               complete  1.80654      1.80654       
submission.csv               2023-01-01 06:21:25  first raw submission               complete  0.46659      0.46659       
</code></pre>
</div>
</div>
<section id="new-score-of-052633" class="cell markdown"
id="pLQz1DaqJIGU">
<h4>New Score of 0.52633</h4>
</section>
<section id="step-7-write-a-report" class="cell markdown"
id="IxJr_Ri5JK6f">
<h2>Step 7: Write a Report</h2>
<p>You can use the report of the notebook in <a
href="./report.md">report.md</a></p>
<h3 id="creating-plots-and-table-for-report">Creating plots and table
for report</h3>
</section>
<div class="cell code" data-execution_count="73"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:390}"
id="pHAT29OiJOEa" data-outputId="42907bd9-6f8d-48f3-c862-c4fe6fc715de">
<div class="sourceCode" id="cb71"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Taking the top model score from each training run and creating a line plot to show improvement</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="co"># You can create these in the notebook and save them to PNG or use some other tool (e.g. google sheets, excel)</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> pd.DataFrame(</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;model&quot;</span>: [<span class="st">&quot;initial&quot;</span>, <span class="st">&quot;add_features&quot;</span>, <span class="st">&quot;hpo&quot;</span>],</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;score&quot;</span>: [<span class="op">-</span><span class="fl">52.835046</span>, <span class="op">-</span><span class="fl">35.679647</span>, <span class="op">-</span><span class="fl">38.163024</span>]</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>).plot(x<span class="op">=</span><span class="st">&quot;model&quot;</span>, y<span class="op">=</span><span class="st">&quot;score&quot;</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>)).get_figure()</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">&#39;model_train_score.png&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="./img/model_train_score.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="74"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:390}"
id="YvI5jveVJOyn" data-outputId="ba5c6cb6-f531-40bd-a7ee-d6231f192a8c">
<div class="sourceCode" id="cb72"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Take the 3 kaggle scores and creating a line plot to show improvement</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> pd.DataFrame(</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;test_eval&quot;</span>: [<span class="st">&quot;initial&quot;</span>, <span class="st">&quot;add_features&quot;</span>, <span class="st">&quot;hpo&quot;</span>],</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;score&quot;</span>: [<span class="fl">1.79580</span>, <span class="fl">0.46465</span>, <span class="fl">0.52633</span>]</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>).plot(x<span class="op">=</span><span class="st">&quot;test_eval&quot;</span>, y<span class="op">=</span><span class="st">&quot;score&quot;</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>)).get_figure()</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">&#39;model_test_score.png&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="./img/model_test_score.png" /></p>
</div>
</div>
<section id="hyperparameter-table" class="cell markdown"
id="KdcgGrzYJS29">
<h3>Hyperparameter table</h3>
</section>
<div class="cell code" data-execution_count="75"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:143}"
id="NGFbMkMRJSDD" data-outputId="c423d156-0e9e-4bd2-d2a6-d20590ff676d">
<div class="sourceCode" id="cb73"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The 3 hyperparameters we tuned with the kaggle score as the result</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>nn_options <span class="op">=</span> {</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;num_epochs&#39;</span>: <span class="dv">10</span>,</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;learning_rate&#39;</span>: ag.space.Real(<span class="fl">1e-4</span>, <span class="fl">1e-2</span>, default<span class="op">=</span><span class="fl">5e-4</span>, log<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;activation&#39;</span>: ag.space.Categorical(<span class="st">&#39;relu&#39;</span>, <span class="st">&#39;softrelu&#39;</span>, <span class="st">&#39;tanh&#39;</span>),</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;dropout_prob&#39;</span>: ag.space.Real(<span class="fl">0.0</span>, <span class="fl">0.5</span>, default<span class="op">=</span><span class="fl">0.1</span>),</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>pd.DataFrame({</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;model&quot;</span>: [<span class="st">&quot;initial&quot;</span>, <span class="st">&quot;add_features&quot;</span>, <span class="st">&quot;hpo&quot;</span>],</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;hpo1&quot;</span>: [<span class="st">&quot;default vals&quot;</span>, <span class="st">&quot;default vals&quot;</span>, <span class="st">&#39;GBM: num_boost_round: 100&#39;</span>],</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;hpo2&quot;</span>: [<span class="st">&quot;default vals&quot;</span>, <span class="st">&quot;default vals&quot;</span>, <span class="st">&#39;GBM: num_boost_round: 200&#39;</span>],</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;hpo3&quot;</span>: [<span class="st">&quot;default vals&quot;</span>, <span class="st">&quot;default vals&quot;</span>, <span class="st">&#39;NN: {num_epochs: 10, learning_rate: 1e-4, 1e-2, activation: relu, softrelu, tanh}&#39;</span>],</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;score&quot;</span>: [<span class="fl">1.79580</span>, <span class="fl">0.46465</span>, <span class="fl">0.52633</span>]</span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<div class="output execute_result" data-execution_count="75">

  <div id="df-dbadb9de-673e-431b-8755-0c61848c45ca">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>model</th>
      <th>hpo1</th>
      <th>hpo2</th>
      <th>hpo3</th>
      <th>score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>initial</td>
      <td>default vals</td>
      <td>default vals</td>
      <td>default vals</td>
      <td>1.79580</td>
    </tr>
    <tr>
      <th>1</th>
      <td>add_features</td>
      <td>default vals</td>
      <td>default vals</td>
      <td>default vals</td>
      <td>0.46465</td>
    </tr>
    <tr>
      <th>2</th>
      <td>hpo</td>
      <td>GBM: num_boost_round: 100</td>
      <td>GBM: num_boost_round: 200</td>
      <td>NN: {num_epochs: 10, learning_rate: 1e-4, 1e-2, activation: relu, softrelu, tanh}</td>
      <td>0.52633</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-dbadb9de-673e-431b-8755-0c61848c45ca')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-dbadb9de-673e-431b-8755-0c61848c45ca button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-dbadb9de-673e-431b-8755-0c61848c45ca');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" id="-nFvhBWD0hkt">
<div class="sourceCode" id="cb74"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>jupyter nbconvert <span class="op">--</span>to html <span class="st">&#39;project.ipynb&#39;</span></span></code></pre></div>
</div>
</body>
</html>
